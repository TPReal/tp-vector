(()=>{var En=Object.create;var qe=Object.defineProperty;var Dn=Object.getOwnPropertyDescriptor;var Fn=Object.getOwnPropertyNames;var Bn=Object.getPrototypeOf,In=Object.prototype.hasOwnProperty;var Cn=(n,t,e)=>t in n?qe(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var Mn=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),X=(n,t)=>{for(var e in t)qe(n,e,{get:t[e],enumerable:!0})},Nn=(n,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Fn(t))!In.call(n,i)&&i!==e&&qe(n,i,{get:()=>t[i],enumerable:!(r=Dn(t,i))||r.enumerable});return n};var Gn=(n,t,e)=>(e=n!=null?En(Bn(n)):{},Nn(t||!n||!n.__esModule?qe(e,"default",{value:n,enumerable:!0}):e,n));var H=(n,t,e)=>(Cn(n,typeof t!="symbol"?t+"":t,e),e);var Tn=Mn((od,Os)=>{Os.exports="data:image/png;base64,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"});var Ie={};X(Ie,{asset:()=>Be,base64:()=>Yn,binary:()=>Un,text:()=>Vn,url:()=>wt});async function Be(n){return(await n).default}var Vn=Be,Un=Be,Yn=Be,wt=Be;function St(n){return n==="X"?"Y":"X"}function sr(n){return Array.isArray(n)&&n.length===2&&typeof n[0]=="number"&&typeof n[1]=="number"}function Z(n){return n.map(([t,e])=>`${V(t)},${V(e)}`).join(" ")}function F(n){return Array.isArray(n)?n.flat(2):[n]}function ee(n){return F(n).filter(t=>t!==void 0)}function Tt(n){return Array.isArray(n)?n.flatMap(t=>sr(t)?[t]:t):[n]}function vt(n,{maxDigits:t=6,maxRelativeError:e=1e-6}={}){for(let r=0;r<t;r++){let i=n.toFixed(r);if(Math.abs(n-Number(i))/n<=e)return i}return n.toFixed(t)}function K(n){if(!n)throw new Error(`Assertion failed, expected truthy, got ${n}`);return n}function or(n){if(typeof n!="number")throw new Error(`Assertion failed, expected number, got ${n}`);return n}function Ce(n,t,{tolerance:e=1e-9}={}){let r=n-t;return r>=-e&&r<=e}var Xn=5,Wn=1e-9;function V(n,{significantDigits:t=Xn,zeroTolerance:e=Wn}={}){if(!Number.isFinite(n))return String(n);if(!n)return"0";let r=Math.abs(n);if(r<=e)return"0";let i=10**(t-1-Math.floor(Math.log10(r)));return String(Math.round(n*i)/i)}function pe(n){let t=n/180*Math.PI;return[Math.sin(t),Math.cos(t)]}var ve=class{constructor(t){this.color=t}static create(t){return new ve(t)}get(t){return this.color}},Me=ve.create("black");var se=class{constructor(t,e,r){this.pool=t;this.nextIndex=r;for(let[i,s]of e)this.setIdIndex(i,s)}usedIndices=new Set;colors=new Map;static create({pool:t,initial:e=[],nextIndex:r=0}){return new se(t,e,r)}setIdIndex(t,e){let r=this.pool[e];return this.colors.set(t,r),this.usedIndices&&(this.usedIndices.add(e),this.usedIndices.size===this.pool.length&&(this.usedIndices=void 0)),r}incNextIndex(){let t=this.nextIndex;return this.nextIndex=(this.nextIndex+1)%this.pool.length,t}get(t){let e=this.colors.get(t);if(e!==void 0)return e;for(;this.usedIndices?.has(this.nextIndex);)this.incNextIndex();let r=this.incNextIndex();return this.setIdIndex(t,r)}};var Re=class{constructor(t){this.id=t;this.href=`#${this.id}`,this.url=`url(${this.href})`}href;url};function ar(n,t="url"){return new Re(n)[t]}var be=class extends Re{constructor(e,r){super(r);this.defs=e}static create(e,r){return new be(e,r)}getDefs(){return this.defs.getDefs()}useByHref(){return this.useByAttribute("href","href")}useByAttribute(e,r){let i=ar(this.id,r),s={};for(let o of F(e))s[o]=i;return de.create(this.defs,s)}},de=class{constructor(t,e){this.defs=t;this.attributes=e}static create(t,e){return new de(t,e)}getDefs(){return this.defs.getDefs()}asAttributes(){return this.attributes}};var Ne={};X(Ne,{get:()=>lr,getGlobalOptions:()=>B,modify:()=>Je,presets:()=>_e,reset:()=>Rt,set:()=>ur});var _e;(a=>{a.DEFAULT={pngAllowTransparency:!0,imageAutoSizeLogic:{measure:!0,widthAndHeight:"_not_set_"},fontFallbackToNotDef:!0};function t(){return{imageAutoSizeLogic:{measure:!1,widthAndHeight:"auto"}}}a.imageAutoSizeLogic=t;function e(){return{cornersMarkerType:"circles",quirks:{xlinkHref:!0},cutRunsStrokeWidth:0}}a.visicut=e;function r({runsHandles:l,colorCodedRunsPreset:u,colorCodedRuns:d=!!u}={}){return{pngAllowTransparency:"iffWhite",cornersMarkerType:"lines",laserRunsOptions:{...d?{colorCodes:()=>se.create({pool:a.LIGHTBURN_RUNS_COLORS,initial:u===!0?a.DEFAULT_LIGHTBURN_COLOR_CODED_RUNS:u})}:void 0,handles:l},quirks:{lineTransformBrokenLightBurn:!0,roundedCornersRectangleLimitedLightBurn:!0}}}a.lightburn=r,a.DEFAULT_LIGHTBURN_COLOR_CODED_RUNS=[["print_back",5],["reversing_frame",10],["print",15],["cut",20],["corners_marker",29]],a.LIGHTBURN_RUNS_COLORS=["#000000","#0000ff","#ff0000","#00e000","#d0d000","#ff8000","#00e0e0","#ff00ff","#b4b4b4","#0000a0","#a00000","#00a000","#a0a000","#c08000","#00a0ff","#a000a0","#808080","#7d87b9","#bb7784","#4a6fe3","#d33f6a","#8cd78c","#f0b98d","#f6c4e1","#fa9ed4","#500a78","#b45a00","#004754","#86fa88","#ffdb66"];function o({runsHandles:l}={}){return cr(r({runsHandles:l}),{cutRunsStrokeWidth:1,fontFallbackToNotDef:!1,quirks:{xlinkHref:!0}})}a.product=o})(_e||={});var ze=_e.DEFAULT;function lr(){return ze}function B(){return lr()}function ur(n,...t){ze=n,Je(...t)}function Rt(...n){ur(_e.DEFAULT,...n)}function Je(...n){ze=cr(ze,...n)}function cr(n,...t){for(let e of F(t))n={...n,...e,laserRunsOptions:{...n.laserRunsOptions,...e.laserRunsOptions},quirks:{...n.quirks,...e.quirks}};return n}var dr={["X"]:{rightOfOrigin:-1,center:0,leftOfOrigin:1},["Y"]:{belowOrigin:-1,center:0,aboveOrigin:1}};function kt(n="default"){return n==="default"?fr:{x:Object.hasOwn(dr["X"],n)?n:"center",y:Object.hasOwn(dr["Y"],n)?n:"center"}}function Hn(n="default"){return typeof n=="string"?kt(n):n}function mr(n="default"){return{...fr,...Hn(n)}}var pr={["X"]:{left:-1,center:0,right:1},["Y"]:{top:-1,center:0,bottom:1}};function Lt(n="default"){return n==="default"?$n:typeof n=="string"?{x:Object.hasOwn(pr["X"],n)?n:"center",y:Object.hasOwn(pr["Y"],n)?n:"center"}:n}var fr={x:"rightOfOrigin",y:"belowOrigin"},$n={x:"left",y:"top"};function oe(n){switch(n){case"rightOfOrigin":case"belowOrigin":case"left":case"top":return-1;case"center":return 0;case"leftOfOrigin":case"aboveOrigin":case"right":case"bottom":return 1;default:throw new Error(`Unexpected argument: ${n}`)}}function gr(n){let{pos:t,min:e,max:r,len:i}=n,s={inferred:n,error:"Incompatible dimensions"};function o({min:a,max:l,len:u,forced:d=!1}){let c=t;if(!Ce(u,l-a)||c==="default"&&a)return s;let g=Ce(l,-a);if(c==="center"&&!g)return s;c||(a?g&&(c="center"):c="default");let f;return u<0&&(f="Negative dimension length"),{inferred:d?n:{pos:c,min:a,max:l,len:u},forceInferred:{min:a,len:u},error:f}}return o(e!==void 0?r!==void 0?i!==void 0?{min:e,max:r,len:i}:{min:e,max:r,len:r-e}:i!==void 0?{min:e,max:e+i,len:i}:t==="default"?{min:e,max:0,len:0}:t==="center"?{min:e,max:-e,len:-2*e}:{min:e,max:0,len:-e,forced:!0}:r!==void 0?i!==void 0?{min:r-i,max:r,len:i}:t==="default"?{min:0,max:r,len:r}:t==="center"?{min:-r,max:r,len:2*r}:{min:0,max:r,len:r,forced:!0}:i!==void 0?t==="default"?{min:0,max:i,len:i}:t==="center"?{min:-i/2,max:i/2,len:i}:{min:0,max:i,len:i,forced:!0}:!t||t==="default"?{min:0,max:1,len:1,forced:!0}:{min:-.5,max:.5,len:1,forced:!0})}function hr(n){return gr(n).inferred}function Et(n){let{forceInferred:t,error:e}=gr(n||{});if(!t)throw new Error(`Error in partial dimension spec: ${e||"(unknown)"} (input: ${JSON.stringify(n)})`);return t}function U(n){let{x:t,y:e,margin:r}=xr(n),{min:i,len:s}=Et(t),{min:o,len:a}=Et(e);return te({minX:i,minY:o,width:s,height:a},r)}function br(n){let{x:t,y:e,margin:r}=xr(n),{left:i,right:s,top:o,bottom:a}=ae(r);function l(u,d,c){let{min:g,len:f}=Et(u);return{min:g-d,len:f+d+c}}return{x:l(t,i,s),y:l(e,o,a)}}function xr(n={}){let{centered:t,centeredX:e=t,centeredY:r=t,side:i,minX:s,maxX:o,width:a=i,minY:l,maxY:u,height:d=i,x:c={pos:e?"center":void 0,min:s,max:o,len:a},y:g={pos:r?"center":void 0,min:l,max:u,len:d},margin:f}=n;return{x:c,y:g,margin:f}}function ae(n={},t=0){return(({value:e=t,x:r=e,y:i=e,left:s=r,right:o=r,top:a=i,bottom:l=i})=>({left:s,right:o,top:a,bottom:l}))(typeof n=="number"?{value:n}:n)}function Dt(n){let{x:t,y:e,width:r,height:i}=n.getBBox();return{minX:t,minY:e,width:r,height:i}}function Ar({left:n,right:t,top:e,bottom:r},i){let{left:s,right:o,top:a,bottom:l}=ae(i,1);return{left:n*s,right:t*o,top:e*a,bottom:r*l}}function te({minX:n,minY:t,width:e,height:r},i){let{left:s,right:o,top:a,bottom:l}=ae(i);return{minX:n-s,width:e+s+o,minY:t-a,height:r+a+l}}function jn({boundingBox:n,viewBox:t}){return{left:n.minX-t.minX,right:t.minX+t.width-(n.minX+n.width),top:n.minY-t.minY,bottom:t.minY+t.height-(n.minY+n.height)}}var Kn=1e-9,qn=["left","right","top","bottom"];function zn({boundingBox:n,viewBox:t,minMargin:e=0}){let r=Math.max(t.width,t.height)*Kn,i=ae(e),s=jn({boundingBox:n,viewBox:t});return qn.map(o=>{let a=i[o],l=s[o];return{side:o,min:a,actual:l,fits:l>=a-r}})}function yr(n){return zn(n).every(({fits:t})=>t)}function xe({minX:n,minY:t,width:e,height:r}){return[n,t,e,r].map(i=>V(i)).join(" ")}var vr="http://www.w3.org/2000/svg",_n=new Map([["xlink","http://www.w3.org/1999/xlink"],["xml","http://www.w3.org/XML/1998/namespace"]]),Jn=["accent-height","alignment-baseline","arabic-form","baseline-shift","cap-height","clip-path","clip-rule","color-interpolation","color-interpolation-filters","color-profile","color-rendering","dominant-baseline","enable-background","fill-opacity","fill-rule","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","glyph-name","glyph-orientation-horizontal","glyph-orientation-vertical","horiz-adv-x","horiz-origin-x","image-rendering","letter-spacing","lighting-color","marker-end","marker-mid","marker-start","overline-position","overline-thickness","panose-1","paint-order","pointer-events","rendering-intent","shape-rendering","stop-color","stop-opacity","strikethrough-position","strikethrough-thickness","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-anchor","text-decoration","text-rendering","transform-origin","underline-position","underline-thickness","unicode-bidi","unicode-range","units-per-em","v-alphabetic","v-hanging","v-ideographic","v-mathematical","vector-effect","vert-adv-y","vert-origin-x","vert-origin-y","word-spacing","writing-mode","x-height"],Rr=new Map;function Qn(n){return n.split("-").map((t,e)=>e?t[0].toUpperCase()+t.slice(1):t).join("")}for(let n of Jn)Rr.set(Qn(n),n);var Zn={vectorEffect:"inherit"};function Pr(n){return typeof n=="number"?V(n):n}var Or="*",kr=["id",Or,"vector-effect"],ei=kr.indexOf(Or);function wr(n){let t=kr.indexOf(n);return t<0?ei:t}function ti(n){return Object.entries(n).sort(([t],[e])=>wr(t)-wr(e))}function W(n,t){for(let[e,r]of ti(t)){let i=Rr.get(e)||e;if(!/^xmlns(:\w+)?$/.test(i)){let o=i.indexOf(":"),a=o>0&&_n.get(i.slice(0,o))||null;r===void 0?n.removeAttributeNS(a,i):n.setAttributeNS(a,i,Pr(r))}else r===void 0?n.removeAttribute(i):n.setAttribute(i,Pr(r));B().quirks?.xlinkHref&&i==="href"&&W(n,{"xlink:href":r})}}function I({tagName:n,attributes:t={},children:e=[]}){let r=document.createElementNS(vr,n);return W(r,{...Zn,...t}),r.append(...ee(e)),r}function ri(){return{xmlns:vr,...B().quirks?.xlinkHref?{"xmlns:xlink":"http://www.w3.org/1999/xlink"}:void 0}}function Qe({viewBox:n,millimetersPerUnit:t,attributes:e={},children:r=[],childrenSeparator:i=!0}){return I({tagName:"svg",attributes:{...n&&t&&{width:`${V(n.width*t)}mm`,height:`${V(n.height*t)}mm`},...ri(),viewBox:n&&xe(n),...e},children:i?[...ee(r).flatMap(s=>[`

`,s]),`

`]:r})}function Ae(n){return n.cloneNode(!0)}function Lr(n){function t(i){return JSON.stringify([i.tagName,i.id,i.getAttributeNames()])}let e=new Map;for(let i of new Set(n)){let s=t(i),o=e.get(s)||[];e.set(s,o),o.push(i)}let r=[];for(let i of e.values())if(i.length===1)r.push(i[0]);else{let s=new Set;for(let o of i){let{outerHTML:a}=o;s.has(a)||(s.add(a),r.push(o))}}return r}var Ft={maxMeasures:3,minSizeCoeff:.1},Sr=U({centered:!0,width:10,height:10}),Tr;function Ze(n){let t=Sr,e=Tr;if(e){for(;e.firstChild;)e.lastChild?.remove();for(let r of n)e.append(r)}else e=Qe({viewBox:t,children:n}),Tr=e;document.body.append(e);try{let r=Dt(e),i=1;for(;i<Ft.maxMeasures&&(r.width<Ft.minSizeCoeff*t.width||r.height<Ft.minSizeCoeff*t.height||!yr({boundingBox:r,viewBox:t}));)t=te(r,{x:r.width/2,y:r.height/2}),W(e,{viewBox:xe(t)}),r=Dt(e),i++;return Sr=t,r}finally{e.remove()}}var po=Qe({viewBox:U()});var S={};X(S,{circle:()=>tt,ellipse:()=>ci,line:()=>Ye,polyLine:()=>pi,polygon:()=>di,rectangle:()=>Le});var Bt=new Set;function Er(n){if(Bt.has(n))throw new Error(`Id already registered: ${n}`);return Bt.add(n),n}function le(n="id"){let t=1,e;do e=`__${n}_${t++}`;while(Bt.has(e));return Er(e)}var q=void 0;function Dr(n){return n===void 0?"":`@${JSON.stringify(n)}`}var It=class{translate(t,e=0){return this.tfData("translate",[t,e])}translateX(t){return this.translate(t)}translateY(t){return this.translate(0,t)}moveUp(t){return this.translateY(-t)}moveDown(t){return this.translateY(t)}moveRight(t){return this.translateX(t)}moveLeft(t){return this.translateX(-t)}scale(...t){let[e,r,i]=typeof t[1]=="number"?t:[t[0],t[0],t[1]];if(i){let[s,o]=i;return this.translate(-s,-o).scale(e,r).translate(s,o)}return this.tfData("scale",[e,r])}scaleX(t,e){return this.scale(t,1,e?[e,0]:void 0)}scaleY(t,e){return this.scale(1,t,e?[0,e]:void 0)}flipX(t){return this.scaleX(-1,t)}flipY(t){return this.scaleY(-1,t)}flipXY(t){return this.scale(-1,t)}swapXY(){return this.rotateRight().flipX()}rotate(t,e){return this.tfData("rotate",[t,...e||[]])}rotateRight(...t){let[e,r]=typeof t[0]=="number"?t:[90,t[0]];return this.rotate(e,r)}rotateLeft(...t){let[e,r]=typeof t[0]=="number"?t:[90,t[0]];return this.rotate(-e,r)}skewX(t,e=0){return e?this.translateY(-e).skewX(t).translateY(e):this.tfData("skewX",[t])}skewTopToRight(t,e=0){return this.skewX(-t,e)}skewTopToLeft(t,e=0){return this.skewX(t,e)}skewBottomToRight(t,e=0){return this.skewX(t,e)}skewBottomToLeft(t,e=0){return this.skewX(-t,e)}skewY(t,e=0){return e?this.translateX(-e).skewY(t).translateX(e):this.tfData("skewY",[t])}skewRightUp(t,e=0){return this.skewY(-t,e)}skewRightDown(t,e=0){return this.skewY(t,e)}skewLeftUp(t,e=0){return this.skewY(t,e)}skewLeftDown(t,e=0){return this.skewY(-t,e)}matrix(t){return this.tfData("matrix",t)}};function ni(n,t){let e=`${n}(${t.map(r=>V(r)).join(",")})`;return t.some(r=>!Number.isFinite(+r))&&console.warn(`Infinite values in transform: ${e}`),e}var Oe=class extends It{tfData(t,e){return this.transform(ye.fromSVGTransform(ni(t,e)))}};var Ge=class extends Oe{constructor(e){super();this.svgTransform=e}static fromSVGTransform(e){return new Ge(e)}transform(e){return new Ge([e.svgTransform,this.svgTransform].filter(Boolean).join(" "))}asAttributes(){return{transform:this.svgTransform||void 0}}toString(){return`transform="${this.svgTransform}"`}},ye=Ge;H(ye,"IDENTITY",new Ge(""));var _=ye.IDENTITY;function Ct(n,t){return t.svgTransform?`${t.svgTransform}*${n}`:`${n}`}function Fr(n,t,e){if(n instanceof t){let r=n[e].baseVal;if(r.length>1){let i=r.consolidate()?.matrix;i&&W(n,{[e]:_.matrix([i.a,i.b,i.c,i.d,i.e,i.f]).svgTransform})}}}function et(n){return Fr(n,SVGGradientElement,"gradientTransform"),Fr(n,SVGGraphicsElement,"transform"),n}function ii(n){return n==="hold"||Object.hasOwn(n,"hold")}function si(n){return Object.hasOwn(n,"scale")}function oi(n){return Object.hasOwn(n,"target")}function Ir(n,t){let e,r,i;if(typeof t=="string"){let f=kt(t);e=f.x,r=f.y,i=void 0}else if(oi(t)){let{x:f,y:p}=br(t.target),m=Lt(t.align);e={...f,align:m.x},r={...p,align:m.y},i=t.fitting||"fit"}else{if(Object.hasOwn(t,"align"))throw new Error("Unexpected align parameter for {x, y} parameters type");e=t.x,r=t.y,i=t.fitting||"fit"}let s=[Br("X",{min:n.minX,len:n.width},e),Br("Y",{min:n.minY,len:n.height},r)];for(let f of s)Number.isFinite(f.scale)||(f.scale=1,f.nInput=!1,f.nOutput=!0);if(i&&i!=="stretch"&&s.some(({nOutput:f})=>f)){let f=s.filter(({nInput:p,nOutput:m})=>p&&!m);if(f.length||(f=s.filter(({nInput:p})=>p)),f.length){let p=(i==="fit"?Math.min:i==="fill"?Math.max:i)(...f.map(({scale:m})=>m));for(let m of s)m.nOutput&&(m.scale=p)}}let[{origPt:o,targetPt:a,scale:l},{origPt:u,targetPt:d,scale:c}]=s,g=_;return(o||u)&&(g=g.translate(-o,-u)),(l!==1||c!==1)&&(g=g.scale(l,c)),(a||d)&&(g=g.translate(a,d)),g}function Br(n,t,e){let r=e;if(!r)return{origPt:0,targetPt:0,scale:1,nInput:!1,nOutput:!1};if(r==="hold")return{origPt:0,targetPt:0,scale:1,nInput:!0,nOutput:!1};if(typeof r=="string")return{origPt:t.min+t.len*(oe(r)+1)/2,targetPt:0,scale:1,nInput:!1,nOutput:!0};if(ii(r)){let d=t.min+t.len*(oe(r.hold)+1)/2,c={origPt:d,targetPt:d};return si(r)?{...c,scale:r.scale,nInput:!0,nOutput:!1}:r.len!==void 0?{...c,scale:r.len/t.len,nInput:!0,nOutput:!0}:{...c,scale:1,nInput:!1,nOutput:!0}}let{min:i,max:s,len:o}=hr(r),a=r.align||r.pos==="center"&&"center",l;if(a)l=oe(a);else if(i!==void 0)l=-1;else if(s!==void 0)l=1;else throw new Error;let u=o===void 0?{scale:1,nInput:!1,nOutput:!0}:{scale:o/t.len,nInput:!0,nOutput:!0};if(l===-1){if(i===void 0)throw new Error(`Error for the ${n} axis: Expected known min for align ${a}`);return{origPt:t.min,targetPt:i,...u}}if(l===1){if(s===void 0)throw new Error(`Error for the ${n} axis: Expected known max for align ${a}`);return{origPt:t.min+t.len,targetPt:s,...u}}if(l===0){if(i===void 0||s===void 0)throw new Error(`Error for the ${n} axis: Expected a definite range for align ${a}`);return{origPt:t.min+t.len/2,targetPt:(i+s)/2,...u}}return l}function Cr(n,t){return!!n&&t.every(e=>typeof n[e]=="function")}function ai(n){return Cr(n,["getDefs"])}function Mt(n){return Cr(n,["getElements","setLayer","selectLayers"])}var ke=class{constructor(t,e){this.element=t;this.layer=e}static create(t,e=q){return new ke(t,e)}getElements(){return[Ae(this.element)]}setLayer(t){return ke.create(this.element,t)}getLayers(){return new Set([this.layer])}selectLayers(...t){return F(t).includes(this.layer)?this:v.EMPTY}},Ve=class{constructor(t){this.defs=t}static create(t){return new Ve(t)}getElements(){return[]}getDefs(){return this.defs.getDefs()}setLayer(){return this}getLayers(){return new Set}selectLayers(){return this}};function Mr(n){return ee(n).map(t=>t instanceof SVGElement?ke.create(t):Mt(t)?t:Ve.create(t))}var C=class extends Oe{constructor(e,r,i,s,o,a){super();this.parts=e;this.tf=r;this.layer=i;this.defs=s;this.attributes=o;this.boundingBoxPiece=a}boundingBox;static create(...e){return new C(Mr(e),_,q,[],{},void 0)}static createElement({tagName:e,attributes:r={},children:i=[]}){let s=[],o=[];for(let a of F(i))Mt(a)?(s.push(...a.getElements()),a.getDefs&&o.push(...a.getDefs())):ai(a)?o.push(...a.getDefs()):s.push(a);return C.create(I({tagName:e,attributes:r,children:s})).addDefs(o)}static createDefs(...e){return C.EMPTY.addDefs(...e)}add(...e){let r=ee(e);return r.length?C.create(this,r):this}addDefs(...e){let r=ee(e);if(!r.length)return this;let i=C.create(r);return new C(this.parts,this.tf,this.layer,[...this.defs,...i.getDefs(),...i.getElements()],this.attributes,this.boundingBoxPiece)}setAttributes(e){return Object.keys(e).length?new C(this.parts,this.tf,this.layer,this.defs,{...this.attributes,...e},this.boundingBoxPiece):this}transform(e){return new C(this.parts,this.tf.transform(e),this.layer,this.defs,this.attributes,this.boundingBoxPiece)}andThen(e,...r){return typeof e!="function"&&(e=e.getFunc()),e(this,...r)}asDefs(){return C.createDefs(this)}asDefTool(e=le()){return be.create(this.setAttributes({id:e}).asDefs(),e)}useDefTool(...e){let r;if(e.length===1)[r]=e;else{let[i,s,o]=e;r=i.useByAttribute(s,o)}return this.setAttributes(r.asAttributes()).addDefs(r)}setLayer(e){return new C(this.parts,this.tf,e,this.defs,this.attributes,this.boundingBoxPiece)}getLayers(){if(this.layer===q){let e=new Set;for(let r of this.parts)for(let i of r.getLayers())e.add(i);return e}return new Set([this.layer])}selectLayers(...e){return this.layer===q?new C(this.parts.map(r=>r.selectLayers(...e)),this.tf,q,this.defs,this.attributes,this.boundingBoxPiece):F(e).includes(this.layer)?this:C.EMPTY}getElements(){return this.withTransformAndAttributes(this.parts.flatMap(e=>e.getElements()))}getBoundingBoxElements(){return this.withTransformAndAttributes(this.boundingBoxPiece?this.boundingBoxPiece.getBoundingBoxElements():this.parts.flatMap(e=>e.getBoundingBoxElements?.()||e.getElements()))}withTransformAndAttributes(e){if(!e.length)return[];let r={...this.attributes,...this.tf.asAttributes()};if(Object.values(r).every(i=>i===void 0))return e;if(e.length===1){let[i]=e,s=new Set(i.getAttributeNames());if(Object.keys(r).every(o=>!s.has(o))){let o=Ae(i);return W(o,r),[et(o)]}}return[et(I({tagName:"g",attributes:r,children:e}))]}getDefs(){return[...this.defs,...this.parts.flatMap(e=>e.getDefs?e.getDefs():[])]}getDefsElement(){let e=this.getDefs();if(e.length)return I({tagName:"defs",children:Lr(e).map(Ae).map(et)})}asG(e){let r=this.getElements();return!e&&r.length===1&&r[0]instanceof SVGGElement?r[0]:I({tagName:"g",attributes:e,children:r})}wrapInG(e={}){return C.create(this.asG(e)).addDefs(this.getDefs())}getBoundingBox(e){if(!this.boundingBox){let r=this.getDefsElement();this.boundingBox=Ze([...r?[r]:[],...this.getBoundingBoxElements()])}return te(this.boundingBox,e)}setBoundingBox(e){return this.tf.svgTransform?C.create(this).setBoundingBox(e):new C(this.parts,this.tf,this.layer,this.defs,this.attributes,C.create(e instanceof SVGElement||Mt(e)?e:li(e)))}extendBoundingBox(e){return this.setBoundingBox(this.getBoundingBox(e))}mirrorX(e){return x(this,this.flipX(e))}mirrorY(e){return x(this,this.flipY(e))}mirrorXY(e){return this.mirrorX(e?.[0]).mirrorY(e?.[1])}normalise(e,{margin:r}={}){return this.transform(Ir(this.getBoundingBox(r),e))}center(){return this.normalise("center")}centerAndFitTo1By1(e){return this.normalise({target:{centered:!0},align:"center"},e)}pad(e,r){return this.normalise({target:te(this.getBoundingBox(),Ar(ae(e),-1)),align:r})}toString(){return Ct(`[${this.parts.join(", ")}]`+Dr(this.layer),this.tf)}},v=C;H(v,"EMPTY",C.create());var re=class extends v{constructor(...t){super(Mr(t),_,q,[],{},void 0)}};function x(...n){return v.create(...n)}function li(n){let{minX:t,minY:e,width:r,height:i}=U(n);return I({tagName:"line",attributes:{x1:t,y1:e,x2:t+r,y2:e+i}})}var Ue=class{constructor(t){this.getPiece=t}static create(t){return new Ue(t)}getWrapped(){return v.create(typeof this.getPiece=="function"?this.getPiece():this.getPiece)}getElements(){return this.getWrapped().getElements()}getDefs(){return this.getWrapped().getDefs()}setLayer(t){return this.getWrapped().setLayer(t)}getLayers(){return this.getWrapped().getLayers()}selectLayers(...t){return this.getWrapped().selectLayers(...t)}},Pe=class extends re{constructor(t){super(Ue.create(t))}};function ui({radiusX:n,radiusY:t=n,xAxisRotationDeg:e=0,largeArc:r=!1,clockwise:i,target:s}){return{radiusX:n,radiusY:t,xAxisRotationDeg:e,largeArc:r,clockwise:i,target:s}}var $=class extends Pe{constructor(e){super(()=>this.getElement());this.commands=e}static create(...e){let[r=[0,0]]=e;return new $([]).moveTo(r)}static fromD(...e){return new $(F(e).map(r=>r.trim()))}getElement(){return I({tagName:"path",attributes:{d:this.asPathD()}})}append(e,r=$){let i=e.map(({command:s,args:o,relative:a=!1})=>{let l=a?s.toLowerCase():s;return o?`${l} ${o}`:l});return new r([...this.commands,...i])}moveTo(e,{relative:r=!1}={}){return this.append([{command:"M",args:Z([e]),relative:r}])}relativeMoveTo(e){return this.moveTo(e,{relative:!0})}appendLineTo(e,r=!1){return this.append(e.map(i=>({command:"L",args:Z([i]),relative:r})))}lineTo(...e){return this.appendLineTo(e)}relativeLineTo(...e){return this.appendLineTo(e,!0)}horizontal(e,{relative:r=!1}={}){return this.append([{command:"H",args:String(e),relative:r}])}relativeHorizontal(e){return this.horizontal(e,{relative:!0})}vertical(e,{relative:r=!1}={}){return this.append([{command:"V",args:String(e),relative:r}])}relativeVertical(e){return this.vertical(e,{relative:!0})}closePath(){return this.append([{command:"Z"}])}appendQuadratic({args:e,relative:r=!1}){return this.append(e.map(({point1:i,target:s})=>i?{command:"Q",args:Z([i,s]),relative:r}:{command:"T",args:Z([s]),relative:r}),Nt)}quadratic(e,...r){return this.appendQuadratic({args:[e,...r]})}relativeQuadratic(e,...r){return this.appendQuadratic({args:[e,...r],relative:!0})}appendCubic({args:e,relative:r=!1}){return this.append(e.map(({point1:i,point2:s,target:o})=>i?{command:"C",args:Z([i,s,o]),relative:r}:{command:"S",args:Z([s,o]),relative:r}),Gt)}cubic(e,...r){return this.appendCubic({args:[e,...r]})}relativeCubic(e,...r){return this.appendCubic({args:[e,...r],relative:!0})}appendArc({args:e,relative:r=!1}){return this.append(e.map(i=>{let{radiusX:s,radiusY:o,xAxisRotationDeg:a,largeArc:l,clockwise:u,target:d}=ui(i);return{command:"A",args:`${V(s)},${V(o)} ${V(a)} ${Number(l)} ${Number(u)} `+Z([d]),relative:r}}))}arc(...e){return this.appendArc({args:e})}relativeArc(...e){return this.appendArc({args:e,relative:!0})}asPathD(){return this.commands.join(" ")}toString(){return`Path[${this.asPathD()}]`}},Nt=class extends ${quadratic(...t){return this.appendQuadratic({args:t})}relativeQuadratic(...t){return this.appendQuadratic({args:t,relative:!0})}},Gt=class extends ${cubic(...t){return this.appendCubic({args:t})}relativeCubic(...t){return this.appendCubic({args:t,relative:!0})}};function tt({center:n=[0,0],radius:t=1}={}){return v.createElement({tagName:"circle",attributes:{cx:n[0],cy:n[1],r:t}})}function ci({center:n=[0,0],radiusX:t=1,radiusY:e=1}={}){return v.createElement({tagName:"ellipse",attributes:{cx:n[0],cy:n[1],rx:t,ry:e}})}function Le({cornerRadius:n=0,cornerRadiusX:t=n,cornerRadiusY:e=n,...r}={}){let{minX:i,minY:s,width:o,height:a}=U(r);if(B().quirks?.roundedCornersRectangleLimitedLightBurn&&(t!==e||2*t>o||2*e>a)){let l=Math.min(t,o/2),u=Math.min(e,a/2),d=o-2*l,c=a-2*u,g={radiusX:l,radiusY:u,clockwise:!0};return $.create([i,s+u]).relativeArc({...g,target:[l,-u]}).relativeHorizontal(d).relativeArc({...g,target:[l,u]}).relativeVertical(c).relativeArc({...g,target:[-l,u]}).relativeHorizontal(-d).relativeArc({...g,target:[-l,-u]}).closePath()}return v.createElement({tagName:"rect",attributes:{x:i,y:s,width:o,height:a,...t?{rx:t}:{},...e?{ry:e}:{}}})}function Ye(...n){let[t,e]=n.length==1?[[0,0],n[0]]:n,r=v.createElement({tagName:"line",attributes:{x1:t[0],y1:t[1],x2:e[0],y2:e[1]}});return B().quirks?.lineTransformBrokenLightBurn?r.wrapInG():r}function di(...n){return v.createElement({tagName:"polygon",attributes:{points:Z(Tt(n))}})}function pi(...n){return v.createElement({tagName:"polyline",attributes:{points:Z(Tt(n))}})}function Nr(n,t,{fill:e=!0,stroke:r}={}){let i={};return e===!1?i.fill="none":e===!0&&(i.fill=t),r&&(i.stroke=t,typeof r=="number"&&(i.strokeWidth=r)),n.setAttributes(i)}var mi=1e6;function Gr(n){return Le({centered:!0,side:n})}var J=class{constructor(t,e,r){this.mask=t;this.attributes=e;this.id=r;this.genId=r}genId;static everything(t){return t?J.incl(Gr(t)):J.EVERYTHING}static incl(t,e){return J.NOTHING.incl(t,e)}static excl(t,{everythingSide:e,...r}={}){return J.everything(e).excl(t,r)}static create(t,{attributes:e,id:r}={}){return new J(t,e,r)}add(t){return new J(this.mask.add(t),this.attributes,void 0)}incl(t,e){return this.add(Nr(t,"white",e))}excl(t,e){return this.add(Nr(t,"black",e))}setAttributes(t){return new J(this.mask,{...this.attributes,...t},void 0)}setId(t){return new J(this.mask,this.attributes,t)}getDefs(){return[I({tagName:"mask",attributes:{id:this.getId()},children:this.mask.getElements()})]}asAttributes(){return{mask:new Re(this.getId()).url}}getId(){return this.genId||(this.genId=le("mask")),this.genId}},Xe=J;H(Xe,"NOTHING",new J(v.EMPTY,{},"mask_nothing")),H(Xe,"EVERYTHING",J.incl(Gr(mi)).setId("mask_everything"));var fi=11;function gi(n){if(Array.isArray(n))return function(l){return l.length!==2||Object.hasOwn(l[0],"offset")}(n)?n:[0,1].map(l=>({offset:l,...n[l]}));let{startOffset:t=0,endOffset:e=1,numStops:r=fi,offsetStep:i=(e-t)/(r-1),func:s}=typeof n=="function"?{func:n}:n;if(i<=0)throw new Error(`Expected positive offset step, got ${i}`);let o=[];for(let a=t;a<=e+1e-9;a+=i){let l=s(a);l&&o.push({offset:a,...l})}return o}var Vr=[void 0,void 0];function hi({offset:n,color:t,opacity:e}){return v.createElement({tagName:"stop",attributes:{offset:n,stopColor:t,stopOpacity:e}})}function Vt({stops:n,spread:t,from:e=Vr,to:r=Vr,transform:i,attributes:s,id:o}){return v.createElement({tagName:"linearGradient",children:gi(n).map(hi),attributes:{spreadMethod:t,x1:e[0],y1:e[1],x2:r[0],y2:r[1],gradientTransform:i?.svgTransform,...s}}).asDefTool(o)}function rt(n){return new Promise((t,e)=>{n.addEventListener("load",t,!1),n.addEventListener("error",r=>{console.error('Waiting for the "load" event, got "error"',n,r),e(r)},!1)})}async function Ee(n){let t=new FileReader,e=rt(t);return t.readAsDataURL(n),await e,t.result}function bi(n){return n.startsWith("data:")}async function Ur(n){if(bi(n))return n;let t;try{t=await(await fetch(n)).blob()}catch(e){throw new Error(`Failed to fetch: ${n}
${e}`,{cause:e})}return await Ee(t)}var Wr={thin:100,regular:400,bold:700};function xi(n){return typeof n=="string"?Wr[n]:n}function Hr(n){if(n?.weight!==void 0)return xi(n.weight);if(n?.bold!==void 0)return Wr[n.bold?"bold":"regular"]}function nt({italic:n,bold:t,weight:e,attributes:r}){let i={...r};return n!==void 0&&(i.fontStyle=n?"italic":"normal"),i.fontWeight=Hr({bold:t,weight:e}),i}var Ai=/^[a-z-]+$/;function yi(n){return Ai.test(n)?n:JSON.stringify(n)}var D=class{constructor(t,e,r,i,s){this.name=t;this.fontAttributes=e;this.defs=r;this.fallback=i;this.finalFallback=s}static async fromBlob({name:t,blob:e,fontAttributes:r,finalFallback:i}){return await D.fromURL({name:t,url:await Ee(e),fontAttributes:r,finalFallback:i})}static async fromURL({name:t,url:e,fontAttributes:r,finalFallback:i}){return await D.fromStyle({name:t,styleContent:`@font-face {
  font-family: ${JSON.stringify(t)};
  src: url(${JSON.stringify(e)});
}`,fontAttributes:r,finalFallback:i})}static async fromAsset({name:t,urlAsset:e,fontAttributes:r,finalFallback:i}){return await D.fromURL({name:t,url:await wt(e),fontAttributes:r,finalFallback:i})}static async fromStyle({name:t,styleContent:e,fontAttributes:r,finalFallback:i=B().fontFallbackToNotDef?D.notDef():void 0}){return new D(t,r,v.createDefs(await wi(e)),void 0,i?await i:void 0)}static system(t,{fontAttributes:e}={}){return new D(t,e,v.EMPTY,void 0,void 0)}static async googleFonts(t,{fontAttributes:e,text:r}={}){return await D.fromStyle({name:t,styleContent:`@import url(${JSON.stringify($r(t,{fontAttributes:e,text:r}))});`,fontAttributes:e})}static async notDef(){return await D.fromURL({name:"Adobe NotDef",url:"https://cdn.jsdelivr.net/gh/adobe-fonts/adobe-notdef/AND-Regular.ttf",finalFallback:!1})}getDefs(){return this.getStack().reduce((t,e)=>t.addDefs(e.defs),v.EMPTY).getDefs()}asAttributes(){return{fontFamily:this.getStack().map(t=>yi(t.name)).join(", "),...this.fontAttributes&&nt(this.fontAttributes)}}getStack(){let t=[],e=this;for(;e;)t.push(e),e=e.fallback;return this.finalFallback&&t.push(this.finalFallback),t}setFallback(t){return new D(this.name,this.fontAttributes,this.defs,t,this.finalFallback)}addFallback(...t){let e=F(t);function r(i){return e.length?i?i.setFallback(r(i.fallback)):r(e.shift()):i}return r(this)}setFinalFallback(t){return new D(this.name,this.fontAttributes,this.defs,this.fallback,t)}clearFinalFallback(){return this.setFinalFallback(void 0)}setFontAttributes(t){return new D(this.name,{...this.setFontAttributes,...t},this.defs,this.fallback,this.finalFallback)}};function $r(n,{fontAttributes:t,text:e}={}){let r=[],i=[];t?.italic&&(r.push("ital"),i.push(1));let s=Hr(t);return s!==void 0&&(r.push("wght"),i.push(s)),`https://fonts.googleapis.com/css2?family=${encodeURIComponent(n)}`+(r.length?`:${r.join(",")}@${i.join(",")}`:"")+(e?`&text=${encodeURIComponent(e)}`:"")}var Pi=/(?<import>@import\s+)?\burl\((?<q>['"]?)(?<url>.+?)\k<q>\)(?<semi>;)?/g,Xr=new Map;async function jr(n){let t=Xr.get(n);if(t!==void 0)return t;let e=[...n.matchAll(Pi)].map(async o=>{let{url:a}=K(o.groups),l;try{l=await(await fetch(a)).blob()}catch(d){throw new Error(`Failed to fetch: ${a}
${d}`,{cause:d})}if(l.type==="text/css"&&o.groups?.import)return{mat:o,text:await jr(await l.text())+`
`};let u=await Ee(l);return{mat:o,text:`url(${JSON.stringify(u)})${o.groups?.semi??""}`}}),r=[],i=0;for(let{mat:o,text:a}of await Promise.all(e))r.push(n.slice(i,o.index)),r.push(a),i=or(o.index)+o[0].length;r.push(n.slice(i));let s=r.join("");return Xr.set(n,s),s}async function wi(n){return I({tagName:"style",children:await jr(n)})}function Si(n="auto"){if(n==="auto")return"auto";let{width:t=1,height:e=1,align:r,fitting:i="fit"}=n;return{width:t,height:e,align:mr(r),fitting:i}}var Y=class extends re{constructor(e,r){super(e);this.image=e;this.scaling=r}static async fromBlob(e){return await Y.fromURL(await Ee(e))}static async fromURL(e){let{url:r,scaling:i=void 0}=typeof e=="string"?{url:e}:e,s=I({tagName:"image"}),o=rt(s);return W(s,{href:await Ur(r)}),await o,Y.fromImage({image:s,canModifyImage:!0,scaling:i})}static async fromAsset(e){let{urlAsset:r,scaling:i=void 0}=e instanceof Promise?{urlAsset:e}:e;return await Y.fromURL({url:await Ie.url(r),scaling:i})}static fromImage(e){let{image:r,canModifyImage:i=!1,scaling:s=void 0}=e instanceof SVGImageElement?{image:e}:e,o=i?r:Ae(r),a=Si(s);return Ti(o,a),new Y(o,a)}setScaling(e){return Y.fromImage({image:this.image,scaling:e})}};function Ti(n,t){if(t==="auto"){let{imageAutoSizeLogic:e}=B();if(e.widthAndHeight==="auto"&&W(n,{width:"auto",height:"auto"}),e.measure){let r=Ze([n]);W(n,{width:r.width,height:r.height})}}else{let{width:e,height:r,align:{x:i,y:s},fitting:o}=t;W(n,{width:e,height:r,x:-e*(oe(i)+1)/2,y:-r*(oe(s)+1)/2,preserveAspectRatio:o==="stretch"?"none":["x",Kr.get(oe(i)),"Y",Kr.get(oe(s))," ",o==="fit"?"meet":"slice"].join("")})}}var Kr=new Map([[-1,"Min"],[0,"Mid"],[1,"Max"]]);var me=class{constructor(t){this.items=t}static create(){return new me([])}first(){return this.items.at(0)}last(){return this.items.at(-1)}add(t,e){if(e<0)throw new Error(`Expected non-negative length, got: ${e}`);if(!e)return this;let r=this.last();return new me(r?.active===t?[...this.items.slice(0,-1),{active:t,length:r.length+e}]:[...this.items,{active:t,length:e}])}addPattern(t){let e=this;for(let{active:r,length:i}of t.items)e=e.add(r,i);return e}reverse(){return new me([...this.items].reverse())}invert(){return new me(this.items.map(({active:t,length:e})=>({active:!t,length:e})))}slice(t,e){let r=this.length(),i=Math.min(Math.max(t,0),r),s=Math.min(Math.max(e??r,0),r);if(s<i)throw new Error(`Expected positive slice, got: from=${t}, to=${e}`);let o=me.EMPTY;if(s>i){let a=0;for(let{active:l,length:u}of this.items){let d=a+u,c=Math.min(s,d)-Math.max(i,a);c>0&&(o=o.add(l,c)),a=d}}return o}length(){return this.items.reduce((t,{length:e})=>t+e,0)}toString(){return this.items.map(({active:t,length:e})=>t?`[${e}]`:`${e}`).join(" ")}},we=me;H(we,"EMPTY",me.create());var z=class{constructor(t){this.pattern=t}static create(t){return new z(t)}static distributed({length:t,tabEveryLen:e,minNumTabs:r=2,numTabs:i=e?Math.ceil(t/e):0,tabToSkipRatio:s=1,tabLength:o,startWithTab:a=!1,endWithTab:l=!1}){i=Math.floor(Math.max(i,r));let u=i+1-Number(a)-Number(l);if(i<0||u<0)throw new Error(`Bad parameters (numTabs=${i}, numSkips=${u})`);let d,c;if(o===void 0){let p=u+i*s;c=t/p,d=c*s}else d=o,c=(t-i*d)/u;let g=z.EMPTY,f=!0;for(;i--;)f&&a||(g=g.base(c)),f=!1,g=g.tab(d);return l||(g=g.base(c)),g}static tab(t){return z.EMPTY.tab(t)}static base(t){return z.EMPTY.base(t)}tab(t){return z.create(this.pattern.add(!0,t))}base(t){return z.create(this.pattern.add(!1,t))}addPattern(t){return z.create(this.pattern.addPattern(t.pattern))}reverse(){return z.create(this.pattern.reverse())}slice(t,e){return z.create(this.pattern.slice(t,e))}matchingTabs(){return z.create(this.pattern.invert())}matchingSlots(){return fe.create(this.pattern)}startsWithTab(){return this.pattern.first()?.active??!1}endsWithTab(){return this.pattern.last()?.active??!1}length(){return this.pattern.length()}toString(){return`TabsPattern[ ${this.pattern} ]`}},E=z;H(E,"EMPTY",z.create(we.EMPTY));var M=class{constructor(t,e,r){this.pattern=t;this.startOpen=e;this.endOpen=r}static create(t,{startOpen:e=t.first()?.active??!0,endOpen:r=t.last()?.active??!0}={}){return new M(t,e,r)}static single(t){return M.closedStart().slot(t).closedEnd()}static slide(t){return M.slot(t).closedEnd()}static slidePair(...t){let e,r;if(t.length==2)[e,r]=t;else{let s=t[0];if(typeof s=="number")e=r=s/2;else{let{length:o,slotLengthsRatio:a=1,slot1LengthFrac:l=a/(a+1)}=s;e=l*o,r=o-e}}let i=we.EMPTY.add(!0,e).add(!1,r);return[M.create(i),M.create(i.invert())]}static distributed({length:t,slotEveryLen:e,minNumSlots:r,numSlots:i,slotToSkipRatio:s,slotLength:o,startWithSlot:a,endWithSlot:l}){return E.distributed({length:t,tabEveryLen:e,minNumTabs:r,numTabs:i,tabToSkipRatio:s,tabLength:o,startWithTab:a,endWithTab:l}).matchingSlots()}static closedStart(t=!0){return t?M.EMPTY_WITH_CLOSED_START:M.EMPTY}static slot(t){return M.EMPTY.slot(t)}static skip(t){return M.EMPTY.skip(t)}slot(t){return M.create(this.pattern.add(!0,t),{startOpen:this.startOpen})}skip(t){return M.create(this.pattern.add(!1,t),{startOpen:this.startOpen})}addPattern(t){return M.create(this.pattern.addPattern(t.pattern),{startOpen:this.startOpen})}reverse(){return M.create(this.pattern.reverse(),{startOpen:this.endOpen,endOpen:this.startOpen})}closedEnd(t=!0){return M.create(this.pattern,{startOpen:this.startOpen,endOpen:!t})}slice(t,e){return M.create(this.pattern.slice(t,e))}matchingTabs(){return E.create(this.pattern)}startsWithSlot(){return this.pattern.first()?.active??!1}endsWithSlot(){return this.pattern.last()?.active??!1}startsWithOpenSlot(){return this.startsWithSlot()&&this.startOpen}endsWithOpenSlot(){return this.endsWithSlot()&&this.endOpen}length(){return this.pattern.length()}toString(){return`SlotsPattern[ ${this.pattern} ]`}},fe=M;H(fe,"EMPTY",M.create(we.EMPTY)),H(fe,"EMPTY_WITH_CLOSED_START",M.create(we.EMPTY,{startOpen:!1}));var ue={};X(ue,{ZERO:()=>Ut,millimeters:()=>vi,oneSideMillimeters:()=>qr,oneSideUnits:()=>Yt,units:()=>Ri});var Ut={oneSideInUnits:0};function vi(n,{millimetersPerUnit:t}){return qr(n/2,{millimetersPerUnit:t})}function qr(n,{millimetersPerUnit:t}){return Yt(n/t)}function Ri(n){return Yt(n/2)}function Yt(n){return{oneSideInUnits:n}}var Q=void 0;function zr(n){return n===Q||typeof n=="string"||typeof n=="number"}var w=class extends re{constructor(e,r,i){super(e);this.path=e;this.state=r;this.stacks=i}static create(...e){let[r=[0,0]]=e;return new w($.create(r),{pos:r,angleDeg:0,down:!0},new Map)}get pos(){return this.state.pos}get angleDeg(){return this.state.angleDeg}get isPenDown(){return this.state.down}asPath(){return this.path}asTransform(){return _.rotateRight(this.angleDeg).translate(...this.pos)}append({path:e=this.path,dAngleDeg:r=0,angleDeg:i=this.angleDeg+r,down:s=this.isPenDown,stackKey:o,stack:a,stacks:l=a?new Map(this.stacks).set(o,a):this.stacks}){return new w(e,{...this.state,angleDeg:i,down:s},l)}appendJump({dPos:e,pos:r=e?[this.pos[0]+e[0],this.pos[1]+e[1]]:void 0,dAngleDeg:i=0,angleDeg:s=this.angleDeg+i}){return new w(r?this.path.moveTo(r):this.path,{...this.state,...r?{pos:r}:{},angleDeg:s},this.stacks)}appendDraw({pathIfDown:e,dPos:r=[0,0],pos:i=[this.pos[0]+r[0],this.pos[1]+r[1]],dAngleDeg:s=0,angleDeg:o=this.angleDeg+s}){return this.isPenDown?new w(e,{...this.state,pos:i,angleDeg:o},this.stacks):this.appendJump({pos:i,angleDeg:o})}appendState({pos:e,angleDeg:r,down:i}){let s=this;return e&&(s=s.appendJump({pos:e})),s.append({angleDeg:r,down:i})}pushInternal(e,r){return this.append({stackKey:e,stack:[...this.stacks.get(e)||[],r]})}push(e=Q){return this.pushInternal(e,this.state)}pushPos(e=Q){return this.pushInternal(e,{pos:this.pos})}pushAngle(e=Q){return this.pushInternal(e,{angleDeg:this.angleDeg})}pushPosAndAngle(e=Q){return this.pushInternal(e,{pos:this.pos,angleDeg:this.angleDeg})}pushPen(e=Q){return this.pushInternal(e,{down:this.isPenDown})}getStackSize(e=Q){let r=this.stacks.get(e);return r?r.length:0}getStackKeys(){return[...this.stacks.keys()]}isStackEmpty(e=Q){return this.getStackSize(e)===0}peek(e=Q){let r=this.stacks.get(e);if(!r||!r.length)throw new Error(`Stack ${JSON.stringify(e??"default")} is empty.`);return this.appendState(K(r.at(-1)))}pop(e=Q){return this.peek(e).append({stackKey:e,stack:K(this.stacks.get(e)).slice(0,-1)})}branch(e,...r){return this.andThen(e,...r).appendState(this.state)}branches(...[e,r,...i]){return this.repeat(e,(s,...o)=>s.branch(r,...o),...i)}repeat(...e){function r(s){return typeof s[0]=="number"}let i=this;if(r(e)){let[s,o,...a]=e;for(let l=0;l<s;l++)i=i.andThen(o,...a,l,s)}else{let[s,o,...a]=e,l=0;for(let u of s)i=i.andThen(o,...a,u,l++,s)}return i}copy(e){return this.appendState(e.state)}copyPos(e){return this.appendState({pos:e.pos})}copyAngle(e){return this.appendState({angleDeg:e.angleDeg})}copyPosAndAngle(e){return this.appendState({pos:e.pos,angleDeg:e.angleDeg})}copyPen(e){return this.appendState({down:e.isPenDown})}dropPath(){return this.append({path:$.create(this.pos)})}penDown(e=!0){return this.append({down:e})}penUp(e=!0){return this.penDown(!e)}withPenDown(...e){let[r=!0,i,...s]=typeof e[0]=="boolean"?e:[void 0,...e],o=this.isPenDown;return this.penDown(r).andThen(i,...s).penDown(o)}withPenUp(...e){let[r=!0,i,...s]=typeof e[0]=="boolean"?e:[void 0,...e];return this.withPenDown(!r,i,...s)}forward(e){return this.goToRelative(e,0)}back(e){return this.forward(-e)}strafeRight(e){return this.goToRelative(0,e)}strafeLeft(e){return this.strafeRight(-e)}goToRelative(e,r){let i=this.relPos(e,r);return this.appendDraw({pathIfDown:this.path.relativeLineTo(i),dPos:i})}goTo(e){return this.appendDraw({pathIfDown:this.path.lineTo(e),pos:e})}jumpTo(e){return this.appendJump({pos:e})}setAngle(e){return this.append({angleDeg:e})}lookUp(){return this.setAngle(0)}lookDown(){return this.setAngle(180)}lookRight(){return this.setAngle(90)}lookLeft(){return this.setAngle(270)}lookAt(e){return this.setAngle(Math.atan2(e[0]-this.pos[0],this.pos[1]-e[1])/Math.PI*180)}right(e=90){return this.append({dAngleDeg:e})}left(e=90){return this.right(-e)}turnBack(){return this.right(180)}curveTo(e,r="quad"){let i={pos:e.pos,angleDeg:e.angleDeg};if(!this.isPenDown)return this.appendJump(i);let s=this,{startSpeed:o,targetSpeed:a}=r==="quad"?{startSpeed:"auto",targetSpeed:void 0}:{startSpeed:r.startSpeed??r.speed??"auto",targetSpeed:r.targetSpeed??r.speed??"auto"},l;function u(p){let[m,h]=pe(p.angleDeg);return[h,m,-h*p.pos[0]-m*p.pos[1]]}function d(){if(!l){let[p,m,h]=u(s),[P,y,k]=u(e),[N,L,b]=[m*k-y*h,P*h-p*k,p*y-P*m];l=[Math.abs(b)<1e-9?void 0:[N/b,L/b]]}return l[0]}function c(p,m,h=1){return m==="auto"?d()||p.pos:p.forward(m*h).pos}let g=c(this,o),f=a===void 0?this.path.quadratic({point1:g,target:e.pos}):this.path.cubic({point1:g,point2:c(e,a,-1),target:e.pos});return this.appendDraw({pathIfDown:f,...i})}curve(e,r){return this.curveTo(this.andThen(e),r)}curveFromPop(...e){let[r=Q,i]=zr(e[0])?e:[void 0,...e];return this.pop(r).curveTo(this,i)}curveFromPeek(...e){let[r=Q,i]=zr(e[0])?e:[void 0,...e];return this.peek(r).curveTo(this,i)}smoothRight(e,r,i){return this.curve(s=>s.forward(r).right(e).forward(r),i)}smoothLeft(e,r){return this.smoothRight(-e,r)}arcRight(e,r){let[i,s]=pe(e),o=this.relPos(r*i,r*(1-s));if(Math.abs(e)<360)return this.appendDraw({pathIfDown:this.path.relativeArc({radiusX:r,target:o,largeArc:i<0==e>0,clockwise:e>0}),dPos:o,dAngleDeg:e});let a=this.appendJump({dPos:o,dAngleDeg:e});return this.isPenDown?a.push().arcRight(180,r).arcRight(180,r).pop():a}arcLeft(e,r){return this.arcRight(-e,-r)}roundCornerRight(e,r=e){let i=this.relPos(e,r);return this.appendDraw({pathIfDown:this.path.relativeArc({target:i,radiusX:r,radiusY:e,xAxisRotationDeg:this.angleDeg,clockwise:e*r>=0}),dPos:i,dAngleDeg:90})}roundCornerLeft(e,r=e){return this.roundCornerRight(e,-r).turnBack()}halfEllipseRight(e,r){let i=this.relPos(0,r);return this.appendDraw({pathIfDown:this.path.relativeArc({target:i,radiusX:r/2,radiusY:e,xAxisRotationDeg:this.angleDeg,clockwise:e*r>=0}),dPos:i,dAngleDeg:180})}halfEllipseLeft(e,r){return this.halfEllipseRight(e,-r)}relPos(e,r){let[i,s]=pe(this.angleDeg);return[e*i+r*s,-e*s+r*i]}circle(e){return this.ellipse(e)}ellipse(e,r=e){return this.state.down?this.branch(i=>i.appendJump({dPos:i.relPos(e,0),dAngleDeg:90}).halfEllipseRight(r,2*e).halfEllipseRight(r,2*e)):this}closePath(){return this.asPath().closePath()}toString(){return`Turtle[${JSON.stringify(this.state)}, stack=${JSON.stringify(this.stacks)}, path=${this.path}]`}};function De({kerf:n,tabWidth:t,tabsDir:e,outerCornersRadius:r=0,innerCornersRadius:i=0}){return{kerf:n,tabWidth:t,tabsDir:e,outerCornersRadius:r,innerCornersRadius:i}}function st({kerf:n,slotWidth:t,slotWidthKerf:e=!0,innerCornersRadius:r=0}){return{kerf:n,slotWidth:t,slotWidthKerf:e===!0?n:e||Ut,innerCornersRadius:r}}function Oi(n){return n instanceof E||n instanceof fe}function _r(n){function t(o){return a=>n(a,o)}function e(o){return(a,l)=>{let u=Oi(l)?{pattern:l}:l;return n(a,{...u,options:{...o,...u.options}})}}function r(o){return o[0]instanceof w}function i(o){let[a]=o;return Object.hasOwn(a,"pattern")&&Object.hasOwn(a,"options")}function s(...o){return r(o)?n(...o):i(o)?t(...o):e(...o)}return s}function Jr({pattern:n,startActive:t,endActive:e}){let r=t,i=[{kind:"boundary",boundary:"start",active:r}];for(let s of n.items)s.active!==r&&(r=s.active,i.push({kind:"activeEdge",newActive:r,useKerf:i.length>1})),i.push({kind:"forward",active:r,length:s.length});return e!==r&&(r=e,i.push({kind:"activeEdge",newActive:r,useKerf:!1})),i.push({kind:"boundary",boundary:"end",active:r}),i}function Qr(n){return n>0?[1,n]:n<0?[-1,-n]:[0,0]}function it(n,t,e,r){return e===0?n.right(90*r):t>0?n.arcRight(90*r,e*r):n.left(90*r).arcRight(270*r,e*r).left(90*r)}var ki=(n,{pattern:t,onTabLevel:e=!1,startOnTab:r=e,endOnTab:i=e,options:s})=>{let{kerf:o,tabWidth:a,outerCornersRadius:l,innerCornersRadius:u}=De(s),d=Jr({pattern:t.pattern,startActive:r==="auto"?t.startsWithTab():r,endActive:i==="auto"?t.endsWithTab():i}),c=s.tabsDir==="right"?1:s.tabsDir==="left"?-1:s.tabsDir;for(let g=0;g+2<d.length;g++){let[f,p,m]=d.slice(g,g+3);if(p.kind==="forward")f.kind==="boundary"&&(n=n.forward(p.length/2)),m.kind==="boundary"&&(n=n.forward(p.length/2));else if(p.kind==="activeEdge"){let h=p.useKerf?o.oneSideInUnits*(p.newActive?-1:1):0,P=(f.kind==="forward"?f.length/2:0)+h,y=(m.kind==="forward"?m.length/2:0)-h;if(P<0||y<0)throw new Error("Kerf too big, negative edge");let k=p.useKerf?[-u,l]:[0,0];p.newActive||k.reverse();let N=[f,m],[[L,b],[A,T]]=k.map((he,ie)=>Qr(N[ie].kind==="boundary"?0:he)),G=c*(p.newActive?1:-1);n=n.forward(P-b).andThen(it,L,b,G).forward(a-b-T).andThen(it,A,T,-G).forward(y-T)}}return n},Li={center:0,right:1,left:-1};function Zr(n){let{slotWidth:t,slotWidthKerf:e}=st(n);return Math.max(0,t-2*e.oneSideInUnits)}var Ei=(n,{pattern:t,dir:e="center",open:r,startOpen:i=r??t.startsWithOpenSlot(),endOpen:s=r??t.endsWithOpenSlot(),options:o})=>{let{kerf:a,slotWidth:l,innerCornersRadius:u}=st(o),d=Jr({pattern:t.pattern,startActive:i,endActive:s});return n.branch(c=>{c=c.withPenUp(f=>f.strafeRight(l/2*Li[e]));let g=Zr(o)/2;for(let f of[1,-1])c=c.branch(p=>{i&&(p=p.withPenUp(h=>h.strafeRight(g*f)));function m(h,P,y){return h.withPenDown(P,k=>k.forward(y))}for(let h=0;h+2<d.length;h++){let[P,y,k]=d.slice(h,h+3);if(y.kind==="forward")P.kind==="boundary"&&(p=p.andThen(m,y.active,y.length/2)),k.kind==="boundary"&&(p=p.andThen(m,y.active,y.length/2));else if(y.kind==="activeEdge"){let N=y.useKerf?a.oneSideInUnits*(y.newActive?1:-1):0,L=(P.kind==="forward"?P.length/2:0)+N,b=(k.kind==="forward"?k.length/2:0)-N;if(L<0||b<0)throw new Error("Kerf too big, negative edge");let[A,T]=Qr(-u);y.newActive?p=p.andThen(m,!1,L).right(90*f).forward(g-T).andThen(it,A,T,-f).forward(b-T):p=p.forward(L-T).andThen(it,A,T,-f).forward(g-T).right(90*f).andThen(m,!1,b)}}return p});return c}).withPenUp(c=>c.forward(d.reduce((g,f)=>f.kind==="forward"?g+f.length:g,0)))},ot=_r(ki),en=_r(Ei);function Di(n){function t(i){return!Object.hasOwn(i,"materialThickness")}let{tabs:e,slots:r}=t(n)?{tabs:n,slots:n}:{tabs:{...n,tabWidth:n.tabWidth??n.materialThickness},slots:{...n,slotWidth:n.slotWidth??n.materialThickness}};return{tabsOptions:De(e),slotsOptions:st(r)}}function tn(n){let{tabsOptions:t,slotsOptions:e}=Di(n);return{tabsOptions:t,tabs:ot(t),slotsOptions:e,slots:en(e)}}var R={};X(R,{column:()=>Wt,fitInBoxes:()=>Ni,layout:()=>Xt,pack:()=>Mi,repeat:()=>Bi,row:()=>Ii});function Fi(n){if(typeof n=="number")return{from:0,step:1,count:n};let{from:t=0,to:e,step:r=1}=n;return{from:t,step:r,count:Math.max(Math.floor((e-t)/r+1e-9)+1,0)}}function*rn(n){let t=F(n).map(Fi);if(t.some(({count:r})=>!r))return;let e=t.map(()=>0);for(;;){yield e.map((i,s)=>{let{from:o,step:a}=t[s];return o+i*a});let r=e.length-1;for(;r>=0&&e[r]===t[r].count-1;)e[r--]=0;if(r<0)return;e[r]++}}function Xt({count:n,pieceFunc:t}){let e=[];for(let r of rn(n)){let i=t(...r);i&&e.push(i)}return x(e)}function Bi({piece:n,rows:t=1,columns:e=1,gap:r=1,gapX:i=r,gapY:s=r}){let{width:o,height:a}=n.getBoundingBox(),l=[];for(let[u,d]of rn([t,e]))l.push(n.translate(d*(o+i),u*(a+s)));return x(l)}function nn(n){function t(e){if(e.length!==1)return!1;let r=e[0];return!!r&&r.constructor===Object&&Object.hasOwn(r,"pieces")}return t(n)?n[0]:{pieces:F(n)}}function Wt(...n){let{pieces:t,gap:e=1,axis:r="Y"}=nn(n),i=0,s=[];for(let o of ee(t)){let a=o.getBoundingBox();s.push(r==="X"?o.translateX(i-a.minX):o.translateY(i-a.minY)),i+=(r==="X"?a.width:a.height)+e}return x(s)}function Ii(...n){return Wt({...nn(n),axis:"X"})}var Ci="default";function Mi(...n){function t(l){return l.length!==1||l[0]instanceof v||Array.isArray(l[0])}let{outline:e,axis:r="X",normaliseItems:i=Ci,gap:s=1}=t(n)?{outline:n}:n[0];function o(l){return i==="none"?l:l.normalise(i)}function a(l,u){return Wt({pieces:l.map(d=>(d instanceof v?d:a(d,St(u))).andThen(o)),gap:s,axis:u})}return a(e,r)}function Ni({pieces:n,boxes:t,repeatBoxes:e=!1,gap:r=1,margin:i=r}){let s=F(t).map(U),o=e?e===!0?s.length:e==="last"?1:e:0;if(o>s.length)throw new Error(`Should repeat the last ${o} boxes, but only ${s.length} specified.`);let a=o?s.slice(-o):[],l=ae(i),u=0;function d(f){let p=[],m=l.left,h=u,P=0;for(;h<n.length;){let y=n[h],k=y.getBoundingBox();if(m+k.width>f-l.right)break;p.push(y.normalise("default").translateX(m)),m+=k.width+r,k.height>P&&(P=k.height),h++}return p.length?{row:x(p),height:P,accept:()=>{u=h}}:void 0}let c=[],g;do{g=!1;for(let f of s){let p=[],m=l.top;for(;;){let h=d(f.width);if(!h||m+h.height>f.height-l.bottom)break;h.accept(),p.push(h.row.translateY(m)),m+=h.height+r}p.length?(g=!0,c.push(x(p).translate(f.minX,f.minY))):c.push(void 0)}s=a}while(g);return u<n.length?{boxedPieces:c,remainingPieces:n.slice(u)}:{boxedPieces:c}}function at(n,t){return t===void 0?`${vt(n)}`:`${vt(n*t,{maxDigits:2})}mm`}function sn({width:n},t){return`__w${at(n,t).replace(".","_")}`}function on(n,t){return t?n+t:n}function an(n){return n.replaceAll(/(\p{Lu}+)(?=\p{Lu}\p{Ll})/gu,"$1 ").replaceAll(/(\p{Ll})(\p{Lu})/gu,"$1 $2").split(/(?:\p{Z}|\p{P})+/gu).filter(Boolean).join("_").toLocaleLowerCase()}var Gi=["preview","laser"];function Fe({styleAttributes:n={},defaults:t}){let e={};for(let r of Gi)e[r]={...t[r],...n[r]};return e}function Ht({id:n,previewColors:t=Me}={}){return{preview:{stroke:t.get(n),strokeWidth:1,vectorEffect:"non-scaling-stroke",fill:"none"},laser:{stroke:"black",strokeWidth:B().cutRunsStrokeWidth??0,vectorEffect:"non-scaling-stroke",fill:"none"}}}var Vi=Ht();function un({id:n,previewColors:t=Me}={}){return{preview:{fill:t.get(n),stroke:t.get(n),strokeWidth:0},laser:{fill:"black",stroke:"black",strokeWidth:0}}}var $l=un();function Ui(n,{id:t="cut",layers:e=t==="cut"?["cut",q]:[t],styleAttributes:r,side:i="front",includeCornersMarker:s=!1,posCorrectionMillimeters:o}){return{type:"cut",id:t,layers:e,styleAttributes:Fe({styleAttributes:r,defaults:Ht({id:t,previewColors:n.previewColors.cut})}),side:i,includeCornersMarker:s,posCorrectionMillimeters:o}}function Yi(n,{id:t="print",layers:e=[t],styleAttributes:r,side:i="front",includeCornersMarker:s=!0,posCorrectionMillimeters:o=n.printPosCorrectionMillimeters}){return{type:"print",id:t,layers:e,styleAttributes:Fe({styleAttributes:r,defaults:un({id:t,previewColors:n.previewColors.print})}),side:i,includeCornersMarker:s,posCorrectionMillimeters:o}}function cn(n,t){return t.type==="cut"?Ui(n,t):t.type==="print"?Yi(n,t):t}var Xi=Fe({styleAttributes:{preview:{stroke:"red"}},defaults:Vi});function Wi(n={}){return Fe({styleAttributes:{preview:{strokeWidth:0},laser:{strokeWidth:0}},defaults:Ht(n)})}function Hi(n=!0){let{type:t=B().cornersMarkerType,enable:e=!!t,id:r="corners_marker",styleAttributes:i={}}=n===!0?{}:n===!1?{enable:!1}:n;return{enable:e,type:t||"circles",id:r,styleAttributes:Fe({styleAttributes:i,defaults:Wi({id:r,previewColors:Me})})}}function $i(n=!0){let{enable:t=!0,id:e="reversing_frame",styleAttributes:r={}}=n===!0?{}:n===!1?{enable:!1}:n;return{enable:t,id:e,styleAttributes:Fe({styleAttributes:r,defaults:Xi})}}var ji=400;function Ki(n={},t){let{pixelsPerInch:e=ji,pixelsPerMillimeter:r=e/25.4,pixelsPerUnit:i=r*(t??1)}=n;return{pixelsPerUnit:i}}var qi=["#404","#084","#840"];function zi(){return se.create({pool:qi,initial:[[void 0,0],["cut",0],["score",1]]})}var _i=["#a00","#0a0","#00a","#aa0","#a0a","#0aa"];function Ji(){return se.create({pool:_i,initial:[[void 0,0],["print",0]]})}function Qi({cut:n=zi(),print:t=Ji()}={}){return{cut:n,print:t}}function Zi({colorCodes:n=B().laserRunsOptions?.colorCodes?.(),handles:t=B().laserRunsOptions?.handles}={}){return{colorCodes:n,handles:t}}var ln=[0,0];function es(n=!0){return n===!0?B().printPosCorrectionMillimeters??ln:n===!1?ln:n}var ts="sheet";function dn({name:n,fileName:t=n?an(n):ts,millimetersPerUnit:e,includeSizeInName:r=e!==void 0,cornersMarker:i,reversingFrame:s,resolution:o,previewColors:a,laserRunsOptions:l,printPosCorrectionMillimeters:u}){return{name:n,fileName:t,includeSizeInName:r,millimetersPerUnit:e,cornersMarker:Hi(i),reversingFrame:$i(s),resolution:Ki(o,e),previewColors:Qi(a),laserRunsOptions:Zi(l),printPosCorrectionMillimeters:es(u)}}function rs(n,t,e){if(Array.isArray(t)){if(!Array.isArray(e))throw new Error(`Cannot merge array with non-array for key ${n}`);return[...t,...e]}if(typeof t=="object"){if(typeof e!="object")throw new Error(`Cannot merge object with non-object for key ${n}`);return e==null?t:t==null?e:pn(t,e)}throw new Error(`Cannot merge values for key ${n}, can only merge objects and arrays`)}function pn(n,t){let e={...n,...t},r=new Set(Object.keys(n));for(let[i,s]of Object.entries(t))r.has(i)&&(e[i]=rs(i,n[i],s));return e}function ge(n){return Object.assign(t=>ge(pn(n,typeof t=="function"?t(n):t)),n)}function $t(n){let t=URL.createObjectURL(new Blob([new XMLSerializer().serializeToString(n)],{type:"image/svg+xml;charset=utf-8"}));return{url:t,cleanUpFunc:()=>{requestAnimationFrame(()=>{URL.revokeObjectURL(t)})}}}function ns({pixelsPerUnit:n,allowTransparency:t=B().pngAllowTransparency}){return{pixelsPerUnit:n,allowTransparency:t}}async function We(n,t){let{pixelsPerUnit:e,allowTransparency:r}=ns(t),{url:i,cleanUpFunc:s}=$t(n),o=n.viewBox.baseVal,a=o.width*e,l=o.height*e,u=document.createElement("canvas");u.width=a,u.height=l;let d=K(u.getContext("2d"));r===!1&&(d.fillStyle="white",d.fillRect(0,0,a,l));let c=new Image;return await new Promise(g=>{c.onload=()=>{if(d.drawImage(c,0,0,u.width,u.height),r==="ifWhite"||r==="iffWhite"){let f=d.getImageData(0,0,a,l),p=f.data;for(let m=0;m<p.length;m+=4){let h=p[m+3];if(h===0)r==="iffWhite"&&(p[m]=255,p[m+1]=255,p[m+2]=255);else if((p[m]&p[m+1]&p[m+2])===255)r==="iffWhite"&&(p[m+3]=0);else if(h!==255){for(let y=0;y<3;y++)p[m+y]=p[m+y]*h/255+255-h;p[m+3]=255}}d.putImageData(f,0,0)}s(),g(u.toDataURL())},c.src=i})}function mn({name:n,url:t,onClickFunc:e}){let r=document.createElement("a");r.style.display="none",r.download=n,r.href=t,r.onclick=e||null,document.body.append(r),r.click(),r.remove()}function jt({name:n,svg:t}){let{url:e,cleanUpFunc:r}=$t(t);mn({name:n,url:e,onClickFunc:r})}async function Kt({name:n,svg:t,conversionParams:e}){mn({name:n,url:await We(t,e)})}var Se=class extends de{constructor(e,r,i){super(e,r);this.textDefTool=i}static create(...e){let[{path:r,textPathAttributes:i,textAttributes:s,align:o,id:a}]=e,l={...i},u={...s};o&&([l.startOffset,u.textAnchor]=o==="start"?["0%","start"]:o==="center"?["50%","middle"]:["100%","end"]);let d=r.asDefTool(a).useByHref();return new Se(d,{...d.asAttributes(),...l},de.create(v.EMPTY,u))}getTextDefTool(){return this.textDefTool}};function j(n,{font:t,size:e=1,fontAttributes:r,textPath:i,attributes:s={}}={}){let o=typeof t=="string"?D.system(t):t,a,l;i?(l=i instanceof Se?i:Se.create(i),a=v.createElement({tagName:"textPath",children:[n]}).useDefTool(l)):a=n;let u=v.createElement({tagName:"text",attributes:{fontSize:e,...r&&nt(r),...s},children:a});return o&&(u=u.useDefTool(o)),l&&(u=u.useDefTool(l.getTextDefTool())),u}var is="solid #00f4 1px";function ss(n,t){t&&(n.style.border=t===!0?is:t)}function os({label:n,hint:t,save:e}){let r=document.createElement("button");return r.textContent=n||"Save",t&&(r.title=t),r.addEventListener("click",e),r}var as=[{type:"print"},{type:"cut"}],O=class{constructor(t,e,r,i,s,o){this.options=t;this.pieces=e;this.viewBox=r;this.runOptions=i;this.emptyRuns=s;this.preserveRunsOrder=o;this.runHandles=this.createHandles()}runHandles;get name(){return this.options.name}static create({options:t={},pieces:e,margin:r=1,viewBox:i="auto",runs:s,preserveRunsOrder:o=!1}){let a=dn(t),l=x(ee(e)),u=ae(r),d=i==="auto"?l.getBoundingBox(u):te(U(i),r),c=F(s||as),g=new Map,f=new Set;for(let p of c){let m=cn(a,p);if(g.has(m.id))throw new Error(`Duplicate run id: ${JSON.stringify(m.id)}`);g.set(m.id,m),l.selectLayers(...m.layers).getElements().length||f.add(m.id)}return new O(a,l,d,g,f,o)}getRunOptions(t){let e=this.runOptions.get(t);if(!e)throw new Error(`No run with id ${JSON.stringify(t)}`);return e}getRunPiece({runOptions:t,medium:e}){let r=this.pieces.selectLayers(...t.layers);if(e==="laser"){if(t.posCorrectionMillimeters&&this.options.millimetersPerUnit!==void 0){let[i,s]=t.posCorrectionMillimeters;r=r.translate(-i/this.options.millimetersPerUnit,-s/this.options.millimetersPerUnit)}t.side==="back"&&(r=r.flipX(this.viewBox.minX+this.viewBox.width/2)),this.options.cornersMarker.enable&&t.includeCornersMarker&&(r=x(r,this.getCornersMarkerRawPiece(e)))}return{defs:r,runGroup:r.asG({id:t.id,...t.styleAttributes[e]})}}getCornersMarkerRawPiece(t){let{minX:e,minY:r,width:i,height:s}=this.viewBox,o;return this.options.cornersMarker.type==="circles"?o=x(tt({center:[e+i,r+s],radius:0}),tt({center:[e,r],radius:0})):this.options.cornersMarker.type==="lines"?o=x(Ye([e,r],[e+1e-9,r]),Ye([e+i,r+s],[e+i-1e-9,r+s])):o=this.options.cornersMarker.type,o.asG({class:this.options.cornersMarker.id,...this.options.cornersMarker.styleAttributes[t]})}getCornersMarker(t){let{id:e}=this.options.cornersMarker;return{id:e,group:this.getCornersMarkerRawPiece(t)}}getReversingFrame(t){let{id:e}=this.options.reversingFrame;return{id:e,group:Le(this.viewBox).asG({id:e,...this.options.reversingFrame.styleAttributes[t]})}}getRunIds(){return[...this.runOptions.keys()]}getNonEmptyRunIds(){return this.getRunIds().filter(t=>!this.emptyRuns.has(t))}runsSelectorFromPartial({medium:t,runsSelector:e={}}={}){let r;Array.isArray(e)?r={runs:e}:r=e;let{runs:i="all",cornersMarker:s="auto",reversingFrame:o="auto"}=r,a=this.runsOrAll(i);function l(){if(!t)throw new Error('Specifying medium is required when using "auto"');return t}if(o===!0&&!this.options.reversingFrame.enable)throw new Error("Cannot specify reversingFrame:true when reversing frame is not enabled in sheet options");if(s===!0&&!this.options.cornersMarker.enable)throw new Error("Cannot specify cornersMarker:true when corners marker is not enabled in sheet options");let u=o==="auto"?this.options.reversingFrame.enable&&l()==="laser"&&a.some(c=>this.getRunOptions(c).side==="back"):o,d=s==="auto"?this.options.cornersMarker.enable&&!u&&l()==="laser"&&!a.some(c=>this.getRunOptions(c).includeCornersMarker):s;return{runs:i==="all"?"all":a,cornersMarker:d,reversingFrame:u}}runsOrAll(t){return t==="all"?this.getNonEmptyRunIds():[...new Set(t)]}getRunsTypes({runs:t,reversingFrame:e}){let r={cut:!1,print:!1};for(let i of this.runsOrAll(t))r[this.getRunOptions(i).type]=!0;return e&&(r.cut=!0),r}laserSVGParamsFromPartial({format:t="SVG",printsAsImages:e=!1,runsSelector:r}={}){return{format:t,printsAsImages:e,runsSelector:this.runsSelectorFromPartial({medium:"laser",runsSelector:r})}}async getRawSVG({medium:t,printsAsImages:e=!1,runsSelector:r={}}){let{runs:i,cornersMarker:s,reversingFrame:o}=this.runsSelectorFromPartial({medium:t,runsSelector:r}),a=[];for(let c of this.runsOrAll(i)){let g=this.getRunOptions(c),f,p;g.type==="print"&&e?p=(await Y.fromURL({url:await We(await this.getRawSVG({medium:t,printsAsImages:!1,runsSelector:{runs:[c],cornersMarker:s,reversingFrame:o}}),this.options.resolution),scaling:{width:this.viewBox.width,height:this.viewBox.height}})).translate(this.viewBox.minX,this.viewBox.minY).asG({id:g.id}):{defs:f,runGroup:p}=this.getRunPiece({runOptions:g,medium:t}),a.push({id:c,defs:f,group:p})}s&&a.push(this.getCornersMarker(t)),o&&a.push(this.getReversingFrame(t));let{laserRunsOptions:l}=this.options;if(t==="laser"){if(l.colorCodes)for(let c of a)c.extraAttributes={fill:l.colorCodes.get(c.id)};if(this.runHandles)for(let c of a)c.sibling=this.runHandles.get(c.id)}let u=x(a.map(({defs:c})=>c)).getDefsElement(),d=a.map(({id:c,group:g,extraAttributes:f,sibling:p})=>f||p?(W(g,{id:void 0}),I({tagName:"g",attributes:{...f,id:c},children:[p,g]})):g);return Qe({viewBox:this.viewBox,millimetersPerUnit:t==="laser"?this.options.millimetersPerUnit:void 0,children:[u,...d]})}createHandles(){let{handles:t}=this.options.laserRunsOptions;if(!t)return;let e=this.getHandleRuns();if(e.length<2)return;let r=this.viewBox.width/e.length,i=100,s=2,o=te(U({width:i,height:15,...t==="above"?{maxY:0}:t==="below"?{minY:0}:t}),-s),a={size:5,font:"monospace"};return new Map(e.map(({runId:l,type:u},d)=>{let c=o.height-4,g=.5,f=Xt({count:c/g+1,pieceFunc:h=>Ye([c,0]).moveUp(h*g)}).translate(2*s,-2*s),p=j(u,a).normalise({target:o,align:{x:"right",y:"center"}},{margin:1}),m=j(l,a).normalise({target:te(o,{left:-c-s,right:-p.getBoundingBox().width}),align:{y:"center"}},{margin:1});return[l,x(Le(o).setAttributes({fill:this.options.laserRunsOptions.colorCodes?void 0:"black"}),f.setAttributes({stroke:"black"}),x(m,p).setAttributes({fill:"black"})).setAttributes({stroke:"none"}).moveRight(d*i).scale(r/i).translate(this.viewBox.minX,this.viewBox.minY).moveDown(t==="below"?this.viewBox.height:0).setAttributes({id:`${l}-handle`}).asG()]}))}getHandleRuns(){let t=[];for(let e of this.getRunsInNaturalOrder()){let r=this.runsSelectorFromPartial({medium:"laser",runsSelector:e});if(r.runs!=="all"){if(r.runs.length)for(let i of r.runs){let s=K(this.runOptions.get(i));t.push({runId:i,type:(s.side==="back"?"-":"")+s.type[0]})}r.reversingFrame&&t.push({runId:this.options.reversingFrame.id,type:"#"})}}return t}async getPreviewSVG({runsSelector:t,saveOnClick:e=!0,border:r=!0,hoverTitle:i=!0}={}){let s=this.runsSelectorFromPartial({medium:"preview",runsSelector:t}),o=await this.getRawSVG({medium:"preview",runsSelector:s});if(ss(o,r),i){let a=I({tagName:"title"});a.textContent=this.getPreviewHoverTitle({runsSelector:s}),o.insertAdjacentElement("afterbegin",a)}return e&&o.addEventListener("click",()=>{this.saveLaserSVG({runsSelector:t})}),o}getPreviewHoverTitle({runsSelector:{runs:t,reversingFrame:e}}){let r=[this.options.fileName];return t!=="all"&&(r.push(" ("),r.push([t.join(", "),e&&"#"].filter(Boolean).join(" ")),r.push(")")),r.push(" (",at(this.viewBox.width,this.options.millimetersPerUnit),"",at(this.viewBox.height,this.options.millimetersPerUnit),")"),r.join("")}async getLaserSVG({printsAsImages:t,runsSelector:e}={}){return await this.getRawSVG({medium:"laser",printsAsImages:t,runsSelector:e})}getSVGName({runsSelector:{runs:t,reversingFrame:e},printsAsImages:r}){let i=[this.options.fileName,...t==="all"?[]:[...t,e&&this.options.reversingFrame.id],r&&"prerendered"].filter(Boolean).join("__"),s=this.options.includeSizeInName?sn(this.viewBox,this.options.millimetersPerUnit):void 0;return on(i,s)}async saveLaserSVG(t={}){let{format:e,printsAsImages:r,runsSelector:i}=this.laserSVGParamsFromPartial(t),s=await this.getLaserSVG({printsAsImages:r,runsSelector:i}),o=this.getSVGName({runsSelector:this.runsSelectorFromPartial({medium:"laser",runsSelector:i}),printsAsImages:r});if(e==="SVG")jt({name:o,svg:s});else if(e==="PNG")await Kt({name:o,svg:s,conversionParams:this.options.resolution});else return e}getFormatLabel(t){return`.${t.toLowerCase()}`}getSaveButtonLabel({format:t,runsSelector:{runs:e,reversingFrame:r}}){let i=[this.options.fileName];return e!=="all"&&(i.push(" ("),i.push([e.join(", "),r&&"#"].filter(Boolean).join(" ")),i.push(")")),t!=="SVG"&&i.push(" ",this.getFormatLabel(t)),i.join("")}getLaserSVGSaveButton({params:t={},label:e,hintLines:r=[]}={}){let{format:i,printsAsImages:s,runsSelector:o}=this.laserSVGParamsFromPartial(t);return os({label:e||this.getSaveButtonLabel({format:i,runsSelector:o}),hint:[this.getSVGName({runsSelector:o,printsAsImages:s}),...r].join(`
`),save:()=>{this.saveLaserSVG({format:i,printsAsImages:s,runsSelector:o})}})}getRunsInSpecifiedOrder(){let t,e=[];for(let{id:r,side:i}of this.runOptions.values())this.emptyRuns.has(r)||(t&&i!==t&&e.push({runs:[],reversingFrame:!0}),t=i,e.push({runs:[r],reversingFrame:!1}));return e}getRunsInNaturalOrder(){if(this.preserveRunsOrder)return this.getRunsInSpecifiedOrder();let t=[...this.runOptions.values()],e=t.some(({side:s})=>s==="back"),r=s=>s.filter(({id:o})=>!this.emptyRuns.has(o)).map(({id:o})=>({runs:[o],reversingFrame:!1}));function i(s){return r(["print","cut"].flatMap(o=>t.filter(({type:a,side:l})=>a===o&&l===s)))}return e?[...i("back"),{runs:[],reversingFrame:!0},...i("front")]:i("front")}getSaveLaserSVGButtons({format:t="SVG",printsFormat:e="both",includePrintsAsImages:r=!0,runsSelectors:i="all"}={}){let s=document.createElement("div");s.textContent="Files for the laser software:";let o=document.createElement("div");s.append(o),o.style.display="flex",o.style.flexWrap="wrap";function a(u){let d=document.createElement("span");d.style.margin="2px";let c=!0;for(let g of F(u))c?c=!1:g.style.marginLeft="-1px",g.style.minHeight="2.2em",d.append(g);o.append(d)}function l(){let u=document.createElement("hr");u.style.margin="2px",o.append(u)}if(i==="all"){let u=this.getRunsInNaturalOrder();i=[{runs:"all"}],u.length>1&&i.push("separator",...u)}for(let u of i)if(u==="separator")l();else{let d=[],c=this.runsSelectorFromPartial({medium:"laser",runsSelector:u}),{cut:g,print:f}=this.getRunsTypes(c),p=f&&!g?e:t,m=p==="both"?"SVG":p,h=[];if(c.runs==="all"?h.push("All the laser runs"):(c.runs.length&&h.push(`Laser runs: ${c.runs.map(P=>JSON.stringify(P)).join(", ")}`),c.reversingFrame&&h.push("Reversing frame")),d.push(this.getLaserSVGSaveButton({params:{format:m,runsSelector:u},hintLines:h})),r&&f&&m==="SVG"&&d.push(this.getLaserSVGSaveButton({params:{format:"SVG",printsAsImages:!0,runsSelector:u},label:"(pre)",hintLines:["With pre-rendered print runs",...h]})),p==="both"&&d.push(this.getLaserSVGSaveButton({params:{format:"PNG",runsSelector:u},label:this.getFormatLabel("PNG"),hintLines:["Raster image",...h]})),c.runs==="all")for(let P of d)P.style.fontWeight="bold";a(d)}return s}getUnusedLayers(){let t=new Set(this.pieces.getLayers());for(let e of this.runOptions.values())for(let r of e.layers)t.delete(r);return[...t.delete(q)?[q]:[],...[...t].sort()]}getUnusedLayersWarning(){let t=this.getUnusedLayers();if(!t.length)return;function e(s){let o=document.createElement("span");return o.style.fontFamily="monospace",o.textContent=s,o}let r=document.createElement("span");r.style.color="#9202ff",r.textContent="Warning: Some layers are not included in any runs: ";let i=!0;for(let s of t)i?i=!1:r.append(", "),r.append(e(s===void 0?"NO_LAYER":JSON.stringify(s)));return r.append("."),r}toString(){return`Sheet[${this.name}, options = ${JSON.stringify(this.options)}, ${this.pieces}, viewBox = "${xe(this.viewBox)}", runs = ${JSON.stringify(this.runOptions)}]`}};function ls(n){return n instanceof E?{pattern:n}:n}function qt(n){return n?"T":"B"}function fn(n){return n==="T"}function lt(n){return n.kind==="hop"}var zt=n=>n;function gn(n){return n==="B"?"base level":"tab level"}function ut(n,t){if(n?.required){if(t?.required&&t.level!==n.level)throw new Error(`Mismatching levels: previous segment ends on ${gn(n.level)}, next segment starts on ${gn(t.level)}`);return n.level}return t?.required?t.level:n?t&&t.level!==n.level?"B":n.level:t?t.level:"B"}var us=1e3;function hn(n,t){return new Proxy({},{get:(e,r)=>t(n[r])})}function _t(n){return n==="auto"||n===void 0?n:!n}function cs({pattern:n,onTabLevel:t,startOnTab:e,endOnTab:r,options:i}){return{pattern:n.matchingTabs(),onTabLevel:_t(t),startOnTab:_t(e),endOnTab:_t(r),options:i}}function xn({pattern:n,onTabLevel:t,startOnTab:e,endOnTab:r,options:i}){return{pattern:n.reverse(),onTabLevel:t,startOnTab:r,endOnTab:e,options:i}}var dt=class{constructor(t){this.tt=t;this.fit=hn(t,e=>xn(cs(e))),this.pat=hn(t,({pattern:e})=>e)}fit;pat;addTabs(t,e){return new dt({...this.tt,[t]:e})}},ct=dt;H(ct,"EMPTY",new dt({}));var ds={up:0,down:180,right:90,left:-90};function ps(n){return n===void 0?0:typeof n=="number"?n:ds[n]}var bn={turnsOnTabLevel:"auto",boxMode:!1};function ms({turnsOnTabLevel:n=bn.turnsOnTabLevel,boxMode:t=bn.boxMode}={}){return{turnsOnTabLevel:n,boxMode:t}}var ce=class extends Pe{constructor(e,r,i,s,o){super(()=>this.asTurtle());this.startAngle=e;this.mode=r;this.options=i;this.segments=s;this.tabsDict=o;this.toTabLevelStrafeLeft=i.tabWidth*(i.tabsDir==="left"?1:-1),this.tt=o.tt,this.fit=o.fit,this.pat=o.pat}toTabLevelStrafeLeft;tt;fit;pat;static create(...e){let[r,{startDir:i,mode:s}={}]=e;return new ce(ps(i),ms(s),De(r),[],ct.EMPTY)}set({options:e,mode:r}){return new ce(this.startAngle,{...this.mode,...r},{...this.options,...e},this.segments,this.tabsDict)}with(e,r,...i){return this.set(e).andThen(r,...i).set({options:this.options,mode:this.mode})}tabs(...e){let{pattern:r,onTabLevel:i,startOnTab:s=i,endOnTab:o=i,options:a}=this.expandTabsFuncParams(e);function l(u,d){return{level:qt(u==="auto"||u===void 0?d:u),required:u!==void 0}}return this.appendSegment({kind:"hop",start:l(s,r.startsWithTab()),end:l(o,r.endsWithTab()),getFunc:(u,d)=>c=>ot(this.options)(c,{pattern:r,startOnTab:fn(u),endOnTab:fn(d),options:{...this.options,...a}})})}tabsDef(e,...r){return this.def(e,this.expandTabsFuncParams(r)).tabs(e)}def(e,...r){return this.appendNamedTabs(e,this.expandTabsFuncParams(r))}noTabs(e,{onTabLevel:r=!1}={}){return this.toTabLevel(r).forward(this.expandTabsFuncParams([e]).pattern.length()).fromTabLevel(r)}expandTabsFuncParams(e){let[r,...i]=e,s=ls(typeof r=="string"?this.tt[r]:r);for(let{reverse:o,...a}of i)s={...s,...a},o&&(s=xn(s));return s}forward(e){return this.appendDual(r=>r.forward(e))}back(e){return this.forward(-e)}strafeRight(e){return this.appendDual(r=>r.strafeRight(e))}strafeLeft(e){return this.strafeRight(-e)}right(e=90){let r=Math.tan(e/2/180*Math.PI);return this.appendDualK(He(e),i=>{let s=this.boxCorrection(e);if(i&&Math.abs(r)>=us)return a=>a.forward(s).andThen(this.turnRightOnLevelK(e,i)).forward(s);let o=s+i*this.toTabLevelStrafeLeft*r;return a=>a.forward(o).right(e).forward(o)})}left(e=90){return this.right(-e)}arcRight(e=90,r=0){let i=this.boxCorrection(e);return this.appendDualK(He(e),s=>o=>o.forward(i).arcRight(e,r+s*this.toTabLevelStrafeLeft).forward(i))}arcLeft(e=90,r=0){return this.arcRight(-e,-r)}bevelRight(e=90){let r=this.boxCorrection(e);return this.appendDualK(He(e),i=>s=>s.forward(r).andThen(o=>{let a=o.andThen(this.turnRightOnLevelK(e,i));return o.goTo(a.pos).copyAngle(a)}).forward(r))}bevelLeft(e=90){return this.bevelRight(-e)}smoothRight(e=90,r=0,i,s=i){let o=this.boxCorrection(e);return this.appendDualK(He(e),a=>l=>l.forward(o).smoothRight(e,r+a*(this.toTabLevelStrafeLeft*Math.tan(e/2/180*Math.PI)),a?s:i).forward(o))}smoothLeft(e=90,r=0,i,s=i){return this.smoothRight(-e,r,i,s)}roundCornerRight(e,r=e){return this.appendDualK(!0,i=>s=>s.roundCornerRight(e+i*this.toTabLevelStrafeLeft,r+i*this.toTabLevelStrafeLeft))}roundCornerLeft(e,r=e){return this.appendDualK(!1,i=>s=>s.roundCornerLeft(e-i*this.toTabLevelStrafeLeft,r-i*this.toTabLevelStrafeLeft))}halfEllipseRight(e,r){return this.appendDualK(r>0,i=>s=>s.halfEllipseRight(e+(r>0?i:-i)*this.toTabLevelStrafeLeft,r+2*i*this.toTabLevelStrafeLeft))}halfEllipseLeft(e,r){return this.halfEllipseRight(e,-r)}andThenTurtle(e,...r){return this.appendDual(i=>i.andThen(e,...r,{onTabLevel:!1}),i=>i.andThen(e,...r,{onTabLevel:!0}))}branchTurtle(...e){function r(a){return typeof a[0]!="function"}let[{fromTabLevel:i=void 0},s,...o]=r(e)?e:[{},...e];return this.appendDual(a=>a.branch(l=>(i===!0?l.withPenUp(this.strafeToTab()):l).andThen(s,...o,{onTabLevel:i??!1})),a=>a.branch(l=>(i===!1?l.withPenUp(this.strafeToTab(-1)):l).andThen(s,...o,{onTabLevel:i??!0})))}toTabLevel(e=!0){let r=qt(e);return this.appendSegment({kind:"hop",start:{level:r},end:{level:r,required:!0},getFunc:(i,s)=>r===i?zt:this.strafeToTab(e?1:-1)})}toBaseLevel(e=!0){return this.toTabLevel(!e)}fromTabLevel(e=!0){let r=qt(e);return this.appendSegment({kind:"hop",start:{level:r,required:!0},end:{level:r},getFunc:(i,s)=>r===s?zt:this.strafeToTab(e?-1:1)})}fromBaseLevel(e=!0){return this.fromTabLevel(!e)}strafeToTab(e=1){return r=>r.strafeLeft(e*this.toTabLevelStrafeLeft)}turnRightOnLevelK(e,r){return i=>i.andThen(this.strafeToTab(-r)).right(e).andThen(this.strafeToTab(r))}boxCorrection(e){if(!this.mode.boxMode)return 0;let r=this.mode.boxMode.verticalEdgesTabWidth;return An({angleDeg:e,tabWidth:r==="same"?this.options.tabWidth:r})}appendDualK(e,r){return(this.mode.turnsOnTabLevel==="auto"?e!==(this.options.tabsDir==="left"):this.mode.turnsOnTabLevel)?this.appendDual(r(-1),r(0)):this.appendDual(r(0),r(1))}appendDual(e,r=e){return this.appendSegment({kind:"dual",getFunc:i=>i==="T"?r:e})}appendSegment(e){if(e.kind==="hop"&&e.start?.required){let r=this.segments.findLast(lt);r&&ut(r.end,e.start)}return new ce(this.startAngle,this.mode,this.options,[...this.segments,e],this.tabsDict)}appendNamedTabs(e,r){return new ce(this.startAngle,this.mode,this.options,this.segments,this.tabsDict.addTabs(e,r))}closeFace({closePath:e=!1,allowOpen:r=e,posTolerance:i=1e-9}={}){let s,o=this.segments.find(u=>u.kind==="hop");if(o){let d={level:ut(this.segments.findLast(lt)?.end,o.start),required:!0},c={kind:"hop",start:d,end:d,getFunc:()=>zt};s=new ce(this.startAngle,this.mode,this.options,[c,...this.segments,c],this.tabsDict)}else s=this;let a=s.asTurtle();r||fs(this.startAngle,a,i);let l=e?a.closePath():a.asPath();return je.create(l,this.tabsDict)}joinFunctions(){let e,r=this.segments.find(lt),i=ut(void 0,r?.start),s=i,o=[];for(let l=0;l<this.segments.length;l++){let u=this.segments[l];if(u.kind==="hop"){let d=s;e=u,r=this.segments.slice(l+1).find(lt),s=ut(e.end,r?.start),o.push(u.getFunc(d,s))}else o.push(u.getFunc(s))}return{func:l=>{for(let u of o)l=u(l);return l},startLevel:i,endLevel:s}}getFunc(){return this.joinFunctions().func}asTurtle(){let{func:e,startLevel:r,endLevel:i}=this.joinFunctions(),s=w.create().setAngle(this.startAngle??0);return r==="T"&&(s=s.withPenUp(this.strafeToTab())),s=s.andThen(e),i==="T"&&(s=s.withPenUp(this.strafeToTab(-1))),s}asPath(){return this.asTurtle().asPath()}},$e=class{constructor(t){this.options=t}static create(t){return new $e(De(t))}create(t){return ce.create(this.options,t)}};function fs(n,{pos:[t,e],angleDeg:r},i){let s=(a,l)=>Ce(a,0,{tolerance:l})?0:a,o=a=>(a%360+360+180)%360-180;if(n=o(n),t=s(t,i),e=s(e,i),r=s(o(r)),t!==0||e!==0||s(o(r-n))!==0)throw new Error(`The face shape is not closed properly: angleDeg=${r} (expected: ${n}), pos=[${t}, ${e}] (expected: [0, 0]${i?` with tolerance ${i}`:""})`)}var je=class extends re{tt;fit;pat;constructor(t,e){super(t),this.tt=e.tt,this.fit=e.fit,this.pat=e.pat}static create(...t){let[e,r]=t;return new je(e,r)}};function Te(n){let t=tn(n);return{...t,TFace:$e.create(t.tabsOptions)}}function An({angleDeg:n,tabWidth:t}){let e=Math.max(pe(n)[1],0);return t*e/(1+e)}function pt({angleDeg:n,tabWidth:t}){let[e,r]=pe(n);return r>=0?t:t/Math.abs(e)}function He(n){return pe(n)[0]>0}async function mt(n,t){return await(typeof n=="function"?n(...t):n)}var gs={mobile:{allSections:"*",up:""},desktop:{allSections:"",up:""}};function hs(){return matchMedia("only screen and (hover: none) and (pointer: coarse) and (max-width: 1000px)").matches}var yn="global_options_preset",ft="width",Pn="section",Jt="/// ";async function Sn({globalOptsMap:n,sectionDefs:t,parent:e=document.body,section:r=new URLSearchParams(location.search).get(Pn)||void 0}){let i=hs(),s=gs[i?"mobile":"desktop"],o;n&&(Rt(),o=new URLSearchParams(location.search).get(yn)??void 0,(o===void 0||!n.has(o))&&(o=n.has("")?"":[...n.keys()].at(0)),o!==void 0&&Je(K(n.get(o))));let a=document.createElement("header");e.append(a),a.style.position="fixed",a.style.top="0",a.style.width="100%",a.style.background="white",a.style.padding="0.5em 0",a.style.display="flex",a.style.flexWrap="wrap",a.style.gap="0.5em";let l=document.createElement("div");e.append(l),l.style.height="2em";let u=document.createElement("select");a.append(u),u.title="Select section",u.style.minWidth="15em",u.addEventListener("change",()=>{h(u.value)});let d=document.createElement("button");a.append(d),d.textContent=s.up,d.addEventListener("click",()=>{h(void 0)});let c=document.createElement("a");if(a.append(c),c.href="#",c.style.alignSelf="center",c.style.color="red",c.addEventListener("click",b=>{b.preventDefault(),h(A=>A.startsWith(Jt))}),n&&(n.size>1||o)){let b=document.createElement("div");a.append(b),b.style.flex="1 0 0";let A=document.createElement("select");a.append(A),A.title="Select global options preset",A.style.minWidth="5em",A.style.marginRight="1em";for(let T of n.keys()){let G=document.createElement("option");A.insertAdjacentElement(T?"beforeend":"afterbegin",G),G.text=T||"(default)",G.value=T}A.value=o||"",A.addEventListener("change",()=>{location.assign(wn(location.href,yn,A.value||void 0))})}let g=document.createElement("div");e.append(g),g.style.display="flex",g.style.gap="4px";let f=document.createElement("div");g.append(f),f.style.flex="0 1 auto",f.style.minWidth="100px";let p=!i&&(localStorage.getItem(ft)||new URLSearchParams(location.search).get(ft));if(f.style.width=p?`${p}px`:"100%",!i){let b=document.createElement("div");g.append(b),b.style.flex="0 0 6px",b.style.backgroundColor="#444",b.style.boxSizing="border-box",b.style.border="2px solid white",b.style.cursor="ew-resize";let A=b.getBoundingClientRect(),T=A.left+A.width/2-f.getBoundingClientRect().width,G=!1;b.addEventListener("mousedown",()=>{G=!0}),document.addEventListener("mouseup",()=>{G=!1}),document.addEventListener("mousemove",he=>{if(G){he.preventDefault();let ie=[...m.children].find(Ln=>Ln.getBoundingClientRect().top>=0)||m.firstElementChild,Ke=ie?.getBoundingClientRect().top??0,Pt=he.clientX-T;f.style.width=`${Pt}px`,f.clientWidth>=Pt?localStorage.setItem(ft,String(Pt)):(f.style.width="100%",localStorage.removeItem(ft)),ie&&window.scrollBy({top:ie.getBoundingClientRect().top-Ke})}})}let m=document.createElement("div");f.append(m),m.style.display="flex",m.style.flexDirection="column",m.style.gap="2em";function h(b,{updateURL:A=!0}={}){b||=()=>!0;let T=typeof b=="string"&&!b.startsWith(Jt)?b:void 0;A&&history.pushState({section:T},"",wn(location.href,Pn,T)),[d.textContent,d.title]=T?[s.allSections,"Show all sections"]:[s.up,"Back to top"],u.value=T||"";let G=typeof b=="function"?b:ie=>ie===b,he=0;for(let ie of document.querySelectorAll(".section")){let Ke=G(ie.id);ie.style.display=Ke?"unset":"none",Ke&&he++}typeof b=="string"&&!he?h(void 0,{updateURL:A}):(e===document.body?document.documentElement:e).scrollTop=0}function P(b){let A=document.createElement("option");A.text=b||`${s.allSections} all sections`,b||(A.style.fontWeight="bold"),A.value=b||"",u.append(A)}function y(b){let A=document.createElement("div");m.append(A),A.style.display="none",A.classList.add("section"),A.id=b,P(b);let T=document.createElement("div");A.append(T),T.style.fontSize="1.5em",T.style.cursor="pointer";let G=document.createElement("span");return T.append(G),G.style.fontWeight="bold",G.textContent="",T.append(` ${b}`),T.addEventListener("click",()=>{h(b)}),A}P(void 0),u.append(document.createElement("hr"));let k=document.createElement("progress");m.append(k),k.style.width="100%";let N=await Promise.allSettled(t.map(b=>mt(b,[])));k.remove();let L=0;for(let b of N)if(b.status==="fulfilled"){let{name:A,element:T}=b.value;y(A).append(T)}else{L++;let A=document.createElement("pre");A.style.color="red",A.textContent=b.reason?.stack||String(b.reason),y(Jt+le("section_error")).append(A)}return L&&(c.textContent=`Failed sections: ${L}`),h(r,{updateURL:!1}),addEventListener("popstate",b=>{h(b.state?.section,{updateURL:!1})}),g}function wn(n,t,e){let r=new URL(n);if(e===void 0?r.searchParams.delete(t):r.searchParams.set(t,e),r.host==="htmlpreview.github.io"){let[i,s]=[...r.searchParams.entries()][0];i.startsWith("https://github.com/")&&!s&&(r.searchParams.delete(i),r.search=`?${i}&${r.searchParams.toString()}`)}return r.toString()}async function bs(n){let t=document.createElement("div");t.style.display="flex",t.style.flexDirection="column",t.style.gap="0.2em";let e=document.createElement("div");t.append(e);let r=await n.getPreviewSVG();e.append(r);let i=n.getUnusedLayersWarning();return i&&t.append(i),t.append(xs(r)),t.append(n.getSaveLaserSVGButtons()),t}function xs(n){let t=document.createElement("div");t.style.display="flex",t.style.gap=".5em",t.style.flexWrap="wrap",t.style.alignItems="center";let e=[];t.append("Show runs:");let r=[];for(let i of n.querySelectorAll(":scope > g[id]")){let s=K(i.getAttribute("id")),o=document.createElement("span");t.append(o),o.title="Right-click to blink",o.style.whiteSpace="nowrap";let a=document.createElement("label");o.append(a);let l=document.createElement("input");a.append(l),r.push(l),l.type="checkbox",l.checked=!0,a.append(s),l.addEventListener("change",()=>{i.style.display=l.checked?"":"none"}),l.addEventListener("dblclick",u=>{u.preventDefault();for(let d of r)d.checked&&d.click();l.click()});for(let u of[a,l])u.addEventListener("contextmenu",d=>{d.preventDefault();for(let c of e)clearTimeout(c);e.length=0;for(let c=0;c<5;c++)e.push(setTimeout(()=>{l.click(),setTimeout(()=>{l.click()},120)},c*240))})}return t}var ne=class{constructor(t,e,r){this.liveReload=t;this.globalOptsMap=e;this.sections=r}static create({liveReload:t=!0,globalOpts:e,globalOptsPresets:r}={}){let i;if(e||r){if(i=new Map,r)for(let[s,o]of Object.entries(r))i.set(s,o);e&&i.set("",e)}return new ne(t,i,[])}addSect(t){return new ne(this.liveReload,this.globalOptsMap,[...this.sections,t])}add(...t){function e(a){let l=a[0];return!!(l&&typeof l=="object"&&Object.hasOwn(l,"getSheet")&&typeof l.getSheet=="function")}e(t)&&(t=[t[0].getSheet,...t.slice(1)]);function r(a){return typeof a[0]=="string"}let[i,s,...o]=r(t)?t:[void 0,...t];return this.addSect(async()=>{let a=await mt(s,o);return a instanceof O?{name:i||a.name||le("sheet"),element:await bs(a)}:{name:i||a.dataset.name||le("section"),element:a}})}addAll(t){return new ne(this.liveReload,this.globalOptsMap,[...this.sections,...t.sections])}async show({parent:t,section:e}={}){return this.liveReload&&ys(),await Sn({globalOptsMap:this.globalOptsMap,sectionDefs:this.sections,parent:t,section:e})}},As=()=>{location.reload()};function ys(n=As){new EventSource("/esbuild").addEventListener("change",n)}var gt={};X(gt,{getSheet:()=>Ps});function Ps(){let n=ge({size:{width:50,height:5},divs:4,margins:.5,dasharray:[2,4,2,6]})(e=>({marginRatio:e.margins/(e.divs+2*e.margins),innerRatio:e.divs/(e.divs+2*e.margins)})),t=x(S.rectangle({...n.size,cornerRadius:.5}),S.rectangle(n.size).useDefTool(Vt({stops:[{color:"white"},{color:"black"}],from:[n.marginRatio,void 0],to:[1-n.marginRatio,void 0]}),["fill","stroke"]).setAttributes({strokeWidth:.3}).setLayer("print"),w.create().repeat(n.dasharray,(e,r,i)=>e.penDown(i%2===0).forward(r)).normalise({y:{min:0,max:n.size.height}}).andThen(e=>R.layout({count:n.divs+1,pieceFunc:r=>e.moveRight((n.marginRatio+r/n.divs*n.innerRatio)*n.size.width)})));return O.create({options:{name:"Gradient calibrator",millimetersPerUnit:1},pieces:t})}var ht={};X(ht,{getSheet:()=>ws});function ws(n){let t=ge({min:0,step:.03,max:.3,...n,tabLen:6,tabsSpace:4,textHeight:3,proberCornersRadius:2})(l=>({count:Math.floor((l.max-l.min)/l.step+1e-9)+1,frameCornersRadius:l.thickness+l.textHeight+l.thickness-l.tabsSpace/2})),e={millimetersPerUnit:1},r={font:"monospace",size:t.textHeight},{tabs:i,slots:s}=Te({kerf:ue.ZERO,materialThickness:t.thickness,tabsDir:"left",outerCornersRadius:.5}),o=(()=>{let l=w.create(),u=E.base(t.tabsSpace).tab(t.tabLen).base(t.tabsSpace);function d(c){return c.andThen(i,u)}for(let c=0;c<2;c++)l=l.andThen(d).arcRight(90,t.proberCornersRadius);return l=l.arcRight(45,t.proberCornersRadius).forward(u.length()*(Math.sqrt(2)-1)/2).andThen(d).forward(u.length()*(Math.sqrt(2)-1)/2).arcRight(135,t.proberCornersRadius),x(l.center().translate(-t.thickness/2,-t.thickness/2),["X","Y"].map((c,g)=>j(c,r).normalise({x:"center",y:{max:-u.length()/2}}).rotateLeft(90*g).setLayer("print"))).normalise("default")})(),a=(()=>{let l=E.base(t.tabsSpace/2).tab(t.tabLen).base(t.tabsSpace/2),u=w.create(),d=[];function c(m){m=m.forward(t.tabsSpace/2);for(let h=0;h<t.count;h++){let P=t.min+h*t.step,y={kerf:ue.millimeters(2*P,e)};d.push(j(P.toFixed(2),r).normalise({x:{pos:"center",len:t.tabLen},y:{min:t.thickness,len:t.textHeight,align:"center"}}).rotate(m.angleDeg-90).translate(...m.forward((t.tabsSpace+t.tabLen)/2).pos)),m=m.branch(k=>k.withPenUp(N=>N.strafeRight(t.thickness+t.textHeight)).andThen(s,{pattern:l.matchingSlots(),dir:"right",options:y})).andThen(i,{pattern:l.matchingTabs(),startOnTab:!0,endOnTab:!0,options:y})}return m.forward(t.tabsSpace/2)}for(let m=0;m<2;m++)u=u.andThen(c).arcRight(90,t.frameCornersRadius);let g=t.count*t.tabLen+(t.count+1)*t.tabsSpace;u=u.arcRight(45,t.frameCornersRadius).forward(g*(Math.sqrt(2)-1)/2).andThen(c).forward(g*(Math.sqrt(2)-1)/2).arcRight(135,t.frameCornersRadius);let f=g/2-t.tabsSpace/2-1.5*t.textHeight,p=f-Math.sqrt(2)*(g/2-f);return x(x(u,x(d).setLayer("print")).center(),["X","Y"].map((m,h)=>j(m,r).normalise({x:"center",y:{max:-f}}).rotateLeft(90*h).setLayer("print")),S.polygon([-f,-f],[p,-f],[-f,p]),R.pack([[o,o],o]).translate(-f+1,-f+1))})();return O.create({options:{name:"Kerf calibrator",...e},pieces:a})}var bt={};X(bt,{getSheet:()=>Ss});function Ss(n={}){let t=ge({max:.5,step:.1,...n,subdivs:2,scoresDist:1.5,scoreLength:6,subdivScoreLength:4})(a=>({unitDist:a.scoresDist*a.subdivs/a.step}));function e({stretch:a=1,getLabel:l}){let u=Math.round(t.max/t.step)*t.subdivs;return R.layout({count:{from:-u,to:u},pieceFunc:d=>(d%t.subdivs?S.line([0,t.subdivScoreLength]):x(S.line([0,t.scoreLength]),x(l?.(d*t.step/t.subdivs)).translateY(t.scoreLength))).moveRight(d*a*t.scoresDist)})}function r(a){return a.toFixed(a?1:0)}function i(a=""){return x(e({stretch:(t.max+t.unitDist)/t.unitDist}).flipY().moveDown(t.max).setLayer("cut"),e({getLabel:l=>j(l?r(l):a+r(l),{font:"monospace",size:2,attributes:{stroke:"none",textAnchor:"end",dominantBaseline:"middle"}}).rotateLeft().moveDown(1)}).setAttributes({strokeWidth:1,vectorEffect:"non-scaling-stroke"}).setLayer("print"))}let s=i("dx = "),o=i("dy = ").rotateRight();return O.create({options:{name:"printPosCorrection calibrator",millimetersPerUnit:1,printPosCorrectionMillimeters:!1},pieces:[s.moveUp(t.max*t.unitDist-t.scoreLength+t.max),o.moveLeft(t.max*t.unitDist+t.scoreLength+2)]})}var Qt={};X(Qt,{getSheet:()=>vs});async function vs(){let n=await(async()=>{let i={coinR:11,outerR:10.5,dentsR:10,numDents:16,dentToSpaceRatio:1.7,dentAngle:130,dentSpeed:3,dentCirclePos:.9,dentCircleR:.5},o=w.create().circle(i.outerR).right(360/i.numDents*(.5/(i.dentToSpaceRatio+1))).withPenUp(a=>a.strafeLeft(i.dentsR)).repeat(i.numDents,a=>a.arcRight(360/i.numDents*(i.dentToSpaceRatio/(i.dentToSpaceRatio+1)),i.dentsR).right(i.dentAngle).curveTo(a.arcRight(360/i.numDents,i.dentsR).left(i.dentAngle),{speed:i.dentSpeed}).right(i.dentAngle)).penUp().arcRight(-360/i.numDents*(.5/(i.dentToSpaceRatio+1)),i.dentsR).strafeRight(i.dentCirclePos).repeat(i.numDents,a=>a.withPenDown(l=>l.circle(i.dentCircleR)).arcRight(360/i.numDents,i.dentsR-i.dentCirclePos)).setAttributes({fillRule:"evenodd"});return x(S.circle({radius:i.coinR}),x(o,j("1",{font:(await D.googleFonts("Sawarabi Mincho",{text:"1"})).setFontAttributes({bold:!0}),size:13}).center()).andThen(a=>x(a.setLayer("print"),a.flipX().setLayer("print_back"))))})(),t=await(async()=>{let i={coinR:10,outerR:9.3,dentsR:8.5,numDents:10,dentAngle:50,dentSpeed:3},s=w.create().branch(a=>a.left(360/i.numDents/4).withPenUp(l=>l.strafeLeft(i.dentsR)).repeat(i.numDents,l=>l.right(i.dentAngle).curveTo(l.arcRight(360/i.numDents,i.dentsR).right(i.dentAngle),{speed:i.dentSpeed}).left(i.dentAngle))),o=s.circle(i.outerR+.2);return x(S.circle({radius:i.coinR}),x(o.setAttributes({fillRule:"evenodd"}),j("2",{font:await D.googleFonts("Domine",{text:"2"}),size:18}).center().moveDown(.5)).andThen(a=>x(a.setLayer("print"),a.flipX().setLayer("print_back"))),s.setLayer("score"),s.flipX().setLayer("score_back"))})(),e=await(async()=>{let i={coinR:12,outerR:11.5,innerR:10.6,numDents:18},s=w.create().lookLeft().left(360/i.numDents/4).withPenUp(o=>o.strafeLeft(i.innerR)).repeat(i.numDents,o=>o.arcRight(360/i.numDents/2,i.innerR).strafeLeft(i.outerR-i.innerR).arcRight(360/i.numDents/2,i.outerR).strafeRight(i.outerR-i.innerR));return x(S.circle({radius:i.coinR}),x(s.setAttributes({fillRule:"evenodd"}),j("5",{font:(await D.googleFonts("Vidaloka",{text:"5"})).setFontAttributes({bold:!0}),size:20}).center().moveDown(1).setAttributes({fill:"white"})).andThen(o=>x(o.setLayer("print"),o.flipX().setLayer("print_back"))))})(),r=[n,t,e];return O.create({options:{name:"Coins",millimetersPerUnit:1},pieces:R.column({pieces:r.map((i,s)=>R.row(...r.slice(s),...r.slice(0,s))),gap:-1}),runs:[{type:"print",id:"print_back",side:"back"},{type:"cut",id:"score_back",side:"back"},{type:"print"},{type:"cut",id:"score"},{type:"cut"}]})}var Zt={};X(Zt,{getSheet:()=>Rs});function Rs(){let n={millimetersPerUnit:1},t=ue.millimeters(.18,n),{TFace:e}=Te({materialThickness:3,kerf:t,tabsDir:"left",outerCornersRadius:.3}),r=E.distributed({length:15,numTabs:2});class i{constructor(p,m){this.base=p;this.sideParams=m}static create({startDir:p}={}){return new s(e.create({startDir:p,mode:{boxMode:{verticalEdgesTabWidth:"same"}}}),[])}}class s extends i{forward(p){let m=E.distributed({length:p,minNumTabs:1,tabEveryLen:15});return new o(this.base.tabs(m.matchingTabs()),[...this.sideParams,{tabsPattern:m,angleBefore:this.sideParams.at(-1)?.angleAfter}])}close({allowOpen:p,posTolerance:m=.1}={}){let h=[],P=[];for(let{tabsPattern:y,angleBefore:k=this.sideParams.at(-1).angleAfter,angleAfter:N}of this.sideParams){let[L,b]=e.create({startDir:"down"}).with({options:{tabWidth:pt({angleDeg:N,tabWidth:e.options.tabWidth})}},A=>A.tabs(r)).right().tabsDef("bottom",y).right().with({options:{tabWidth:pt({angleDeg:k,tabWidth:e.options.tabWidth})}},A=>A.tabs(r.matchingTabs().reverse())).right().andThen(A=>[A.noTabs("bottom"),A.tabs("bottom",{reverse:!0})].map(T=>T.right().closeFace()));h.push(L),P.push(b)}return{base:this.base.closeFace({allowOpen:p,posTolerance:m}),openTopSides:h,closedTopSides:P}}}class o extends i{right(p=90){return new s(this.base.right(p),[...this.sideParams.slice(0,-1),{...this.sideParams.at(-1),angleAfter:p}])}left(p=90){return this.right(-p)}}let a=i.create({startDir:"right"}).forward(45).left().forward(15).right().forward(10).right().forward(15).left().forward(20).right(50).forward(30).right(130).forward(10).left().forward(50).right().forward(85).right().forward(50).left().forward(10).right(108.5).forward(24.4).right(71.5).close(),l=i.create().forward(20).left().forward(15).left().forward(20).left().forward(15).left().close(),u=x(a.base,l.base.translate(40,55)),d=R.row({pieces:[u.center(),u.flipY().center(),u.center()],gap:-12}),c=[...a.openTopSides,...l.openTopSides],g=[...a.closedTopSides,...l.closedTopSides];return O.create({options:{name:"House box",...n},pieces:R.column({pieces:[d,...[c,g].map(f=>R.fitInBoxes({pieces:f,boxes:{width:d.getBoundingBox().width,height:1e6}}).boxedPieces[0])],gap:5})})}var er={};X(er,{getSheet:()=>ks});async function ks(){let[n,t,e,r]=(await Promise.all([Y.fromAsset(Promise.resolve().then(()=>Gn(Tn()))),Y.fromURL("https://upload.wikimedia.org/wikipedia/commons/thumb/6/6a/JavaScript-logo.png/240px-JavaScript-logo.png"),Y.fromURL("https://raw.githubusercontent.com/evanw/esbuild/main/images/logo.svg"),Y.fromURL("https://upload.wikimedia.org/wikipedia/commons/8/84/Deno.svg")])).map(s=>s.centerAndFitTo1By1()),i=.05;return O.create({options:{name:"Images demo",resolution:{pixelsPerInch:2e3}},pieces:R.pack({outline:[[[n,t],[e,r]]],gap:i}).setLayer("print"),margin:0})}var tr={};X(tr,{getSheet:()=>Ls});function Ls(){let e={x1B:.1,angle1B:7,fwdBase:.25,fwdB:.1,y2B:.05,x2Base:.25,x2B:.05,angle2B:10,speedBase:.35,speedB:.05};function r(o,a=0){return a+(Math.random()-.5)*2*o}function i(o){let a=w.create().lookDown(),l=a.withPenUp(u=>u.strafeRight(r(e.x1B)).right(r(e.angle1B)));for(let u=0;u<o;u++){let d=a.forward(r(e.y2B,.5)).strafeRight((Math.random()<.5?1:-1)*r(e.x2B,e.x2Base)).right(r(e.angle2B));a=a.forward(1);let c=a.strafeRight(r(e.x1B)).right(r(e.angle1B));l=l.forward(r(e.fwdB,e.fwdBase)).curveTo(d,{speed:r(e.speedB,e.speedBase)}).curveTo(c.back(r(e.fwdB,e.fwdBase)),{speed:r(e.speedB,e.speedBase)}).goTo(c.pos)}return l}let s=x(R.layout({count:{from:1,to:15-1},pieceFunc:o=>i(10).moveRight(o)}),R.layout({count:{from:1,to:10-1},pieceFunc:o=>i(15).rotateLeft().moveDown(o)}),S.rectangle({width:15,height:10,cornerRadius:.3}));return O.create({options:{name:"Jigsaw puzzle"},pieces:s,margin:0})}function vn({min:n,max:t}){let e=x(S.line([n+.2,0],[t-.2,0]),S.line([t-.2,0],[t-.5,.2]),S.line([t-.2,0],[t-.5,-.2]));for(let r=n+1;r<t;r++)r&&(e=e.add(S.line([r,-.1],[r,.1])));return e}function xt(n){let{minX:t,width:e,minY:r,height:i}=U(n);if(t>0||t+e<0||r>0||r+i<0)throw new Error(`Expected a ViewBox containing the origin ([0, 0]), got: ${xe({minX:t,width:e,minY:r,height:i})}`);return x(vn({min:t,max:t+e}),vn({min:r,max:r+i}).rotateRight())}function At(n){let t=U(n);return x(S.rectangle({...t,cornerRadius:.5}),w.create().forward(1).right().forward(.15).arcRight(180,.2).branch(e=>e.forward(.15)).turnBack().forward(.05).arcRight(180,.3).forward(.2).scale(.5,[0,-.5]).moveRight(.5-.125).moveDown(1).translate(t.minX,t.minY))}async function yt(n,t=n.getRunIds().map(e=>({label:e,runIds:[e]}))){let e=document.createElement("div");e.dataset.name=n.name||"",e.style.display="flex",e.style.flexWrap="wrap",e.style.gap="1em 1px";for(let{label:r,runIds:i}of t){let s=document.createElement("div");s.style.flex="1 0 160px",s.style.maxWidth="200px",s.append(await n.getPreviewSVG({runsSelector:i}));let o=document.createElement("div");o.style.font="0.8em monospace",o.style.paddingRight="1em",o.textContent=r,s.append(o),e.append(s)}return e}async function Rn(){let n={minX:2,width:3,minY:1,height:2},t={centered:!0,side:2},e={minX:-10,maxX:10,minY:-10,maxY:10},i=[{args:void 0},{args:"default"},{args:"center"},{args:"aboveOrigin"},{args:{target:t},target:t},{args:{target:t,align:"center"},target:t},{args:{target:t,align:{x:"right",y:"bottom"}},target:t},{args:{target:t,fitting:"fill"},target:t},{args:{target:t,fitting:"fill",align:"center"},target:t},{args:{target:t,fitting:"stretch"},target:t},{args:{x:"rightOfOrigin",y:"aboveOrigin"}},{args:{x:"rightOfOrigin"}},{args:{x:{min:1,max:3}},target:{...e,x:{min:1,max:3}}},{args:{x:{min:1,max:3},y:{min:0,max:1}},target:{x:{min:1,max:3},y:{min:0,max:1}}},{args:{x:{min:1,max:3,align:"center"},y:{min:0,max:1}},target:{x:{min:1,max:3},y:{min:0,max:1}}},{args:{x:{min:1,max:3},y:{min:0,max:1},fitting:"stretch"},target:{x:{min:1,max:3},y:{min:0,max:1}}},{args:{x:{min:-2},y:{max:0}},target:{x:{min:-2,max:10},y:{max:0,min:-10}}},{args:{x:{max:1,pos:"center"},y:"belowOrigin"},target:{...e,x:{max:1,pos:"center"}}},{args:{x:{len:2,pos:"center",align:"right"},y:{pos:"default",len:1}},target:{x:{len:2,pos:"center"},y:{pos:"default",len:1}}},{args:{x:{len:2,pos:"center"},y:{len:2,pos:"center"},fitting:"fill"},target:{x:{len:2,pos:"center"},y:{len:2,pos:"center"}}},{args:{x:{hold:"right",scale:.5}},target:{...e,x:{max:n.minX+n.width,len:n.width*.5}},holdX:n.minX+n.width},{args:{x:{min:-1,len:2,align:"right"},y:{hold:"center",len:1}},target:{x:{min:-1,len:2},y:{min:n.minY+n.height/2-1/2,len:1}},holdY:n.minY+n.height/2},{args:{x:{min:-1,len:2},y:{hold:"top"}},target:{...e,x:{min:-1,len:2}},holdY:n.minY},{args:{x:{hold:"right",len:2},y:{hold:"bottom"}},target:{...e,x:{max:n.minX+n.width,len:2}},holdX:n.minX+n.width,holdY:n.minY+n.height},{args:{x:{hold:"right",len:2}},target:{x:{max:n.minX+n.width,len:2},y:{min:n.minY,len:n.height}},holdX:n.minX+n.width},{args:{x:{hold:"right",len:2},y:"hold"},target:{x:{max:n.minX+n.width,len:2},y:{min:n.minY,len:n.height}},holdX:n.minX+n.width,holdY:n.minY+n.height/2},{args:{x:{hold:"right",scale:.5},y:"hold"},target:{x:{max:n.minX+n.width,len:n.width/2},y:{min:n.minY,len:n.height}},holdX:n.minX+n.width,holdY:n.minY+n.height/2},{args:{x:{hold:"right",len:2},y:"hold",fitting:"stretch"},target:{x:{max:n.minX+n.width,len:2},y:{min:n.minY,len:n.height}},holdX:n.minX+n.width,holdY:n.minY+n.height/2},{args:{x:"rightOfOrigin",y:{hold:"top",scale:.5}},target:{...e,y:{min:n.minY,len:n.height*.5}},holdY:n.minY}].map(({args:l,target:u,holdX:d,holdY:c})=>({args:l,target:u,holdX:d,holdY:c,label:l?JSON.stringify(l).replaceAll(/([,:])/g,"$1 ").replaceAll(/"([^\\"()]+)":/g,"$1:"):"(original)"})),s={minX:-3,maxX:6,minY:-3,maxY:4},o=xt(s),a=At(n);return await yt(O.create({options:{name:"Normalise explainer"},viewBox:s,margin:.1,pieces:x(o.setLayer("axes"),...i.map(({args:l,target:u,holdX:d,holdY:c,label:g})=>x(l?a.normalise(l):a,u&&S.rectangle(u).setAttributes({stroke:"green"}),d===void 0?void 0:S.line([d,-10],[d,10]).setAttributes({stroke:"violet"}),c===void 0?void 0:S.line([-10,c],[10,c]).setAttributes({stroke:"violet"})).setLayer(g))).setAttributes({stroke:"black"}),runs:i.map(({label:l})=>({type:"cut",id:l,layers:["axes",l]}))}))}var rr={};X(rr,{getSheet:()=>Ds});function Ds(){let n={millimetersPerUnit:1},t=ue.millimeters(.18,n),e={thickness:3,drawerGap:.3,drawerHandleWidth:20,drawerHandleHeight:14},{slots:r,TFace:i}=Te({kerf:t,materialThickness:e.thickness,tabsDir:"left",outerCornersRadius:.3});class s{constructor(p,m,h){this.innerWidth=p;this.innerHeight=m;this.innerDepth=h;this.outerWidth=p+2*e.thickness,this.outerHeight=m+e.thickness,this.outerDepth=h+2*e.thickness}outerWidth;outerHeight;outerDepth;static create(p){return new s(p.innerWidth,p.innerHeight,p.innerDepth)}}function o({innerWidth:f,innerHeight:p,innerDepth:m}){let[h,P]=i.create({startDir:"down"}).tabsDef("side",E.distributed({length:p,tabEveryLen:15})).right().tabsDef("bottom",E.distributed({length:f,tabEveryLen:20})).right().tabs("side").right().andThen(N=>[N.andThenTurtle(L=>L.forward((f-e.drawerHandleWidth)/2).curve(b=>b.forward(e.drawerHandleWidth/2).strafeRight(e.drawerHandleHeight),{startSpeed:4,targetSpeed:10}).curve(b=>b.forward(e.drawerHandleWidth/2).strafeLeft(e.drawerHandleHeight),{startSpeed:10,targetSpeed:4}).forward((f-e.drawerHandleWidth)/2)),N.noTabs("bottom")].map(L=>L.right().closeFace())),y=i.create({startDir:"down"}).tabs(P.fit.side).right().tabsDef("bottom",E.distributed({length:m,tabEveryLen:20})).right().tabs(h.fit.side).right().noTabs("bottom").right().closeFace(),k=i.create().tabs(y.fit.bottom).right().tabs(P.fit.bottom).right().tabs(y.fit.bottom).right().tabs(h.fit.bottom).right().closeFace();return{front:h,back:P,side:y,bottom:k}}let a=s.create({innerWidth:30,innerHeight:30,innerDepth:50}),l=s.create({innerWidth:-e.thickness+a.outerWidth+e.drawerGap+e.thickness+e.drawerGap+a.outerWidth-e.thickness,innerHeight:40,innerDepth:a.innerDepth}),u=(()=>{let{front:f,back:p,side:m,bottom:h}=o(a);return R.pack([[f,p],m,m,h.rotateRight()])})(),d=(()=>{let{front:f,back:p,side:m,bottom:h}=o(l);return R.pack([h,[f,m],[p,m]])})();function c(f,p){let m=i.create().tabsDef("back",E.distributed({length:e.drawerGap+p.outerHeight+e.drawerGap+e.thickness+e.drawerGap+f.outerHeight+e.drawerGap,tabEveryLen:20})).right().tabsDef("top",E.distributed({length:p.outerDepth,tabEveryLen:20})).right().noTabs("back").andThen(L=>L.branchTurtle(b=>b.withPenUp(A=>A.back(e.drawerGap+p.outerHeight+e.drawerGap)).right().andThen(r,{pattern:L.pat.top.matchingSlots(),dir:"right"}))).right().tabsDef("bottom","top").right().closeFace(),h=i.create().tabsDef("back",E.distributed({length:e.drawerGap+f.outerHeight+e.drawerGap,tabEveryLen:20})).right().tabsDef("top",m.tt.top).right().noTabs("back").right().tabsDef("bottom","top").right().closeFace(),P=i.create().tabsDef("side",m.tt.top).right().tabsDef("back",E.distributed({length:e.drawerGap+p.outerWidth+e.drawerGap,tabEveryLen:20})).right().tabs("side").right().noTabs("back").andThen(L=>L.branchTurtle(b=>b.withPenUp(A=>A.back(L.pat.back.length()/2)).right().andThen(r,h.pat.bottom.matchingSlots()))).right().closeFace(),[y,k]=i.create().tabsDef("side",m.fit.top).right().tabsDef("back",E.distributed({length:e.drawerGap+p.outerWidth+e.drawerGap,tabEveryLen:20})).right().tabs("side").right().noTabs("back").andThen(L=>[L,L.branchTurtle(b=>b.withPenUp(A=>A.back(P.pat.back.length()/2)).right().andThen(r,h.pat.top.matchingSlots()))].map(b=>b.right().closeFace())),N=i.create().branchTurtle(L=>L.withPenUp(b=>b.forward(e.drawerGap+p.outerHeight+e.drawerGap).strafeRight(e.thickness)).right().branch(b=>b.andThen(r,{pattern:P.pat.back.matchingSlots(),dir:"left"})).withPenUp(b=>b.forward(P.pat.back.length()/2).left().forward(e.thickness)).andThen(r,h.pat.back.matchingSlots())).tabs(m.fit.back).right().tabs(k.fit.back).right().tabs(m.fit.back).right().tabs(y.fit.back).right().closeFace();return{divider:h,shelf:P,top:k,bottom:y,leftSide:m,back:N}}let g=(()=>{let{divider:f,shelf:p,top:m,bottom:h,leftSide:P,back:y}=c(a,l);return R.pack([[p.rotateRight(),m.rotateRight(),h.rotateRight(),f.rotateRight()],[P,P.flipX(),y]])})();return O.create({options:{name:"Tabs and slots",...n},pieces:R.pack([g,[R.row({pieces:[u.center(),u.rotate(180).center()],gap:-(2*a.outerWidth-a.outerDepth)}),d]])})}var nr={};X(nr,{getSheet:()=>Fs});function Fs(){let n="#009dff",e=x(S.circle({radius:1}).setAttributes({fill:n}),R.layout({count:11,pieceFunc:r=>r?S.line([0,-8]).moveUp(5).rotate(r*360/11):void 0}),S.line([0,-14]),w.create([-10,-18]).setAngle(160).forward(4).left(70).forward(22).withPenUp(r=>r.right(40).back(4)).forward(4).right(100).forward(4)).setAttributes({fill:"none",stroke:n,strokeWidth:1.2}).centerAndFitTo1By1({margin:.5}).setBoundingBox(S.rectangle({centered:!0})).setLayer("print");return O.create({options:{name:"TPVector icon",resolution:{pixelsPerUnit:256}},pieces:e,margin:0})}async function On(){let n=["","translate(1, 2)","translateX(1)","translateY(-1)","moveLeft(1)","moveDown(2)","scale(1.5)","scale(1.5, 0.5)","scale(2, [1.5, 1])","scaleX(1 / 3)","scaleY(-2, 1)","flipY()","flipX(1.5)","flipXY()","swapXY()","rotateRight(20)","rotateLeft(45, [1.5, 1])","rotateRight([1.5, 1])","skewRightDown(45)","skewTopToLeft(60, 1)","skewLeftDown(10, 3)","matrix([-1.2, 0.8, 0.5, 1.4, 3, -1])"];function t(s){return s?new Function("Tf",`return Tf.${s}`)(_):_}let e={minX:-2,maxX:6,minY:-2,maxY:5},r=xt(e),i=At({width:3,height:2});return await yt(O.create({options:{name:"Transform explainer"},viewBox:e,margin:.1,pieces:x(i.setLayer("orig_object").setAttributes({stroke:"#ccc"}),x(r.setLayer("axes"),...n.map(s=>i.transform(t(s)).setLayer(s))).setAttributes({stroke:"black"})),runs:n.map(s=>({type:"cut",id:s||"(identity)",layers:["axes","orig_object",s]}))}))}var ir={};X(ir,{getSheet:()=>Is});function Is(){return O.create({options:{name:"Turtle demo"},pieces:R.row({pieces:[(()=>{let n=w.create(),t=n.forward(1).right().forward(.5);for(let e=.35;e<=2;e+=.3)n=n.branch(r=>r.curveTo(t,{startSpeed:1.6,targetSpeed:e}));return n})(),(()=>{function n(e,r){return e.right().forward(r/2).halfEllipseRight(r+2,2*r)}let t=w.create().forward(10);for(let e=1;e<=5;e++)t=t.forward(1).branch(n,e);return t})(),(()=>w.create().right(1.75*360/11).repeat(5,e=>e.right(360*4/11).forward(1)).extendBoundingBox({right:-.2}))(),(()=>{let n=w.create();for(let t=1;t<10;t++)n=n.arcLeft(90,t).forward(3).arcLeft(90,t);return n.arcLeft(110,16)})(),w.create().arcRight(160,1).branch(n=>n.right(140).push()).withPenUp(n=>n.arcRight(40,1)).branch(n=>n.left(140).curveFromPeek({speed:.6}).curveFromPop({speed:.8})).arcRight(160,1),(()=>{function n(t,e){return e?t.forward(1<<e).branch(r=>r.right(80).andThen(n,e-1)).branch(r=>r.left(80).andThen(n,e-1)):t}return w.create().andThen(n,6)})(),(()=>{let t=w.create().circle(1).penUp().repeat(13,e=>e.right(27.692307692307693).branch(r=>r.strafeRight(1.08).withPenDown(i=>i.ellipse(.2,.35))));return x(t.setAttributes({fill:"#ddd",fillRule:"evenodd"}).setLayer("print"),t)})(),w.create().right(10).curve(n=>n.forward(1).right(90).forward(.5),{speed:4}).curve(n=>n.forward(2).lookDown().right(10).forward(4)).curve(n=>n.forward(1).left(130).forward(2)).extendBoundingBox({left:-1})].map((n,t)=>n.normalise({target:{side:1,minX:0,maxY:0}}).scale(t<3?1:.6)),gap:.1}),margin:.1})}var kn=ne.create().add(nr).add(ir).add(Qt).add(tr).add(rr).add(Zt).add(er).add(ht,{thickness:3}).add(bt).add(gt).add(On).add(Rn);(async()=>await ne.create({globalOpts:[Ne.presets.lightburn(),{cutRunsStrokeWidth:1,fontFallbackToNotDef:!1}]}).addAll(kn).show())();})();
